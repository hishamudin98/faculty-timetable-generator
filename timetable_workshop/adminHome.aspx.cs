using iTextSharp.text;
using iTextSharp.text.pdf;
using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Windows.Forms;
using System.Collections;

namespace timetable_workshop
{
    public partial class adminHome : System.Web.UI.Page
    {
        Timetable_proEntities ent = new Timetable_proEntities();
        Random rnd = new Random();
        string nl = Environment.NewLine;
        protected void Page_Load(object sender, EventArgs e)
        {
            //string email = Request.QueryString["email"];
            //DropDownList1.SelectedValue = "";
            string email = Session["email"].ToString();
            var whichAdmin = ent.Admins.Where(x => x.email == email).FirstOrDefault();
            Image2.ImageUrl = "~/Properties/details.png";
            Label1.Text = whichAdmin.Name;

            var allroom = ent.Rooms.ToList();
            var alllect = ent.Lecturers.ToList();
            LabelTotalClass.Text = "Total amount of room and lab in FTMK is " + allroom.Count().ToString();
            LabelTotalLecturer.Text = "Total lecturer for FTMK is " + alllect.Count().ToString();

            var slot = ent.Slots.ToList();
            string firstname = Request.QueryString["profilename"];
            //string lastname = Request.QueryString["id"];
            var whichAdmin1 = ent.Admins.Where(x => x.Name == firstname).FirstOrDefault();

            //Button4.Enabled = false;
            //Button5.Enabled = false;
            //Button1.Enabled = true;

            if(!slot.Any())
            {
                Button4.Enabled = false;
                Button5.Enabled = false;
                Button1.Enabled = true;
            }
            else if (slot.Count() == 227)
            {
                Button4.Enabled = false;
                Button5.Enabled = false;
                Button1.Enabled = false;
            }
            else
            {
                Button4.Enabled = true;
                Button5.Enabled = true;
                Button1.Enabled = true;
            }

            GridView1.Visible = false;

        }

        protected void ButtonGenerate_Click(object sender, EventArgs e)
        {
            string email = Session["email"].ToString();
            var whichAdmin = ent.Admins.Where(x => x.email == email).FirstOrDefault();
            Response.Redirect("adminHome.aspx?profilename=" + whichAdmin.Name + "&id=" + whichAdmin.ID);
        }

        protected void ButtonLect_Click(object sender, EventArgs e)
        {

            string email = Session["email"].ToString();
            var whichAdmin = ent.Admins.Where(x => x.email == email).FirstOrDefault();
            Response.Redirect("adminLecturer.aspx?profilename=" + whichAdmin.Name + "&id=" + whichAdmin.ID);

        }

        protected void ButtonRoom_Click(object sender, EventArgs e)
        {
            string email = Session["email"].ToString();
            var whichAdmin = ent.Admins.Where(x => x.email == email).FirstOrDefault();
            Response.Redirect("adminRoom.aspx?profilename=" + whichAdmin.Name + "&id=" + whichAdmin.ID);
        }

        protected void ButtonProfile_Click(object sender, EventArgs e)
        {
            string email = Session["email"].ToString();
            var whichAdmin = ent.Admins.Where(x => x.email == email).FirstOrDefault();
            Response.Redirect("adminProfile.aspx?profilename=" + whichAdmin.Name + "&id=" + whichAdmin.ID);
        }

        protected void ButtonAdd_Click(object sender, EventArgs e)
        {
            string email = Session["email"].ToString();
            var whichAdmin = ent.Admins.Where(x => x.email == email).FirstOrDefault();
            Response.Redirect("addNewAdmin.aspx?profilename=" + whichAdmin.Name + "&id=" + whichAdmin.ID);
        }

        protected void ButtonLogOut_Click(object sender, EventArgs e)
        {
            if (MessageBox.Show("Do you really want to logout?", "Warning", MessageBoxButtons.YesNo, MessageBoxIcon.Warning) == DialogResult.Yes)
            {
                Session.Abandon();
                Session.Clear();
                Session.RemoveAll();
                Response.Redirect("loginPage.aspx");
                HttpContext.Current.Response.Cache.SetCacheability(HttpCacheability.NoCache);
            }
        }

        protected void Button3_Click(object sender, EventArgs e)
        {
            if (MessageBox.Show("Are you sure you want to clear all the data ?", "Warning", MessageBoxButtons.YesNo, MessageBoxIcon.Warning) == DialogResult.Yes)
            {
                var allslot = ent.Slots.ToList();
                SqlCommand cmd;
                SqlConnection con;
                con = new SqlConnection("Server = .\\SQLEXPRESS; Initial Catalog = Timetable_pro; Integrated Security = True");
                con.Open();
                string strSql = "TRUNCATE TABLE Slot";
                cmd = new SqlCommand(strSql, con);
                cmd.ExecuteNonQuery();
                MessageBox.Show("Success cleared", "Success", MessageBoxButtons.OK, MessageBoxIcon.Information);

                for (int j = 0; j < GridView1.Rows.Count; j++)
                {
                    for (int k = 1; k < GridView1.Columns.Count; k++)
                    {
                        GridView1.Rows[j].Cells[k].Text = "";
                    }
                }

                Button1.Enabled = true;
                Button4.Enabled = false;
                Button5.Enabled = false;
            }
        }

        protected void GridView1_RowDataBound1(object sender, GridViewRowEventArgs e)
        {
            //e.Row.Cells[1].Width = 1;
            e.Row.Cells[0].Width = 1;
            //e.Row.Cells[4].Width = 75;
            //e.Row.Cells[5].Width = 1;
            int gcolumn = GridView1.Columns.Count;

            for (int i = 1; i < gcolumn; i++)
            {
                e.Row.Cells[i].Width = 500;
            }
        }
        protected void ButtonPDF_Click(object sender, EventArgs e)
        {


        }
        protected void Button1_Click(object sender, EventArgs e)
        {
            if (MessageBox.Show("Do you want to generate timetable for all course", "Warning", MessageBoxButtons.YesNo, MessageBoxIcon.Warning) == DialogResult.Yes)
            {
                int rooms = 0;

                // all slots
                var kira = ent.Slots.ToList();

                // all rooms
                var lecturerRooms = ent.Rooms.Where(x => x.Type_ID == 1).ToList().ToArray();



                //1 DIT
                var sub1DITnoLab = ent.View_1DIT.Where(x => x.Name.Contains("1 DIT") && x.CodeName.StartsWith("DIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub1DITPBPI = ent.View_1DIT.Where(x => x.Name.Contains("1 DIT") && x.CodeName.StartsWith("DLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //var stud1DIT0 = sub1DITnoLab[0];

                //2 DIT
                var sub2DITnoLab = ent.View_1DIT.Where(x => x.Name.Contains("2 DIT") && x.CodeName.StartsWith("DIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub2DITPBPI = ent.View_1DIT.Where(x => x.Name.Contains("2 DIT") && x.CodeName.StartsWith("DLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //MessageBox.Show(sub2DITnoLab[2].ToString());

                //1 BITC
                var sub1BITCnoLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITC") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub1BITCPBPI = ent.View_1DIT.Where(x => x.Name.Contains("1 BITC") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //2 BITC
                var sub2BITCnoLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITC") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub2BITCPBPI = ent.View_1DIT.Where(x => x.Name.Contains("2 BITC") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //3 BITC
                var sub3BITCnoLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITC") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub3BITCPBPI = ent.View_1DIT.Where(x => x.Name.Contains("3 BITC") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();

                //1 BITD
                var sub1BITDnoLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITD") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub1BITDPBPI = ent.View_1DIT.Where(x => x.Name.Contains("1 BITD") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //2 BITD
                var sub2BITDnoLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITD") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub2BITDPBPI = ent.View_1DIT.Where(x => x.Name.Contains("2 BITD") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //3 BITD
                var sub3BITDnoLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITD") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub3BITDPBPI = ent.View_1DIT.Where(x => x.Name.Contains("3 BITD") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();

                //1 BITE
                var sub1BITEnoLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITE") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub1BITEPBPI = ent.View_1DIT.Where(x => x.Name.Contains("1 BITE") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //2 BITE
                var sub2BITEnoLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITE") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub2BITEPBPI = ent.View_1DIT.Where(x => x.Name.Contains("2 BITE") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //3 BITE
                var sub3BITEnoLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITE") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub3BITEPBPI = ent.View_1DIT.Where(x => x.Name.Contains("3 BITE") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();

                //1 BITI
                var sub1BITInoLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITI") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub1BITIPBPI = ent.View_1DIT.Where(x => x.Name.Contains("1 BITI") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //2 BITI
                var sub2BITInoLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITI") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub2BITIPBPI = ent.View_1DIT.Where(x => x.Name.Contains("2 BITI") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //3 BITI
                var sub3BITInoLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITI") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub3BITIPBPI = ent.View_1DIT.Where(x => x.Name.Contains("3 BITI") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();

                //1 BITM
                var sub1BITMnoLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITM") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub1BITMPBPI = ent.View_1DIT.Where(x => x.Name.Contains("1 BITM") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //2 BITM
                var sub2BITMnoLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITM") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub2BITMPBPI = ent.View_1DIT.Where(x => x.Name.Contains("2 BITM") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //3 BITM
                var sub3BITMnoLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITM") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub3BITMPBPI = ent.View_1DIT.Where(x => x.Name.Contains("3 BITM") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();

                //1 BITS
                var sub1BITSnoLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITS") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub1BITSPBPI = ent.View_1DIT.Where(x => x.Name.Contains("1 BITS") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //2 BITS
                var sub2BITSnoLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITS") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub2BITSPBPI = ent.View_1DIT.Where(x => x.Name.Contains("2 BITS") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //3 BITS
                var sub3BITSnoLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITS") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub3BITSPBPI = ent.View_1DIT.Where(x => x.Name.Contains("3 BITS") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();

                //1 BITZ
                var sub1BITZnoLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITZ") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub1BITZPBPI = ent.View_1DIT.Where(x => x.Name.Contains("1 BITZ") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //2 BITZ
                var sub2BITZnoLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITZ") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub2BITZPBPI = ent.View_1DIT.Where(x => x.Name.Contains("2 BITZ") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                //3 BITZ
                var sub3BITZnoLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITZ") && x.CodeName.StartsWith("BIT") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();
                var sub3BITZPBPI = ent.View_1DIT.Where(x => x.Name.Contains("3 BITZ") && x.CodeName.StartsWith("BLHW") && x.TypeID == 1).Select(x => x.SubjectName + nl + x.Name).ToList().ToArray();


                int i = 0;
                //int p = 0;

                ArrayList arrayList = new ArrayList();

                ArrayList arrayPBPI = new ArrayList();

                for (int l = 0; l < sub2DITnoLab.Count(); l++)
                {
                    //DIT
                    if (l < sub1DITnoLab.Count())
                    {
                        arrayList.Add(sub1DITnoLab[l]);
                    }

                    arrayList.Add(sub2DITnoLab[l]);

                    //BITC
                    if (l < sub1BITCnoLab.Count())
                    {
                        arrayList.Add(sub1BITCnoLab[l]);
                    }
                    if (l < sub2BITCnoLab.Count())
                    {
                        arrayList.Add(sub2BITCnoLab[l]);
                    }
                    if (l < sub3BITCnoLab.Count())
                    {
                        arrayList.Add(sub3BITCnoLab[l]);
                    }

                    //BITD
                    if (l < sub1BITDnoLab.Count())
                    {
                        arrayList.Add(sub1BITDnoLab[l]);
                    }
                    if (l < sub2BITDnoLab.Count())
                    {
                        arrayList.Add(sub2BITDnoLab[l]);
                    }
                    if (l < sub3BITDnoLab.Count())
                    {
                        arrayList.Add(sub3BITDnoLab[l]);
                    }
                    //

                    //BITE
                    if (l < sub1BITEnoLab.Count())
                    {
                        arrayList.Add(sub1BITEnoLab[l]);
                    }
                    if (l < sub2BITEnoLab.Count())
                    {
                        arrayList.Add(sub2BITEnoLab[l]);
                    }
                    if (l < sub3BITEnoLab.Count())
                    {
                        arrayList.Add(sub3BITEnoLab[l]);
                    }
                    //

                    //BITI
                    if (l < sub1BITInoLab.Count())
                    {
                        arrayList.Add(sub1BITInoLab[l]);
                    }
                    if (l < sub2BITInoLab.Count())
                    {
                        arrayList.Add(sub2BITInoLab[l]);
                    }
                    if (l < sub3BITInoLab.Count())
                    {
                        arrayList.Add(sub3BITInoLab[l]);
                    }
                    //
                    //BITM
                    if (l < sub1BITMnoLab.Count())
                    {
                        arrayList.Add(sub1BITMnoLab[l]);
                    }
                    if (l < sub2BITMnoLab.Count())
                    {
                        arrayList.Add(sub2BITMnoLab[l]);
                    }
                    if (l < sub3BITMnoLab.Count())
                    {
                        arrayList.Add(sub3BITMnoLab[l]);
                    }
                    //
                    //BITS
                    if (l < sub1BITSnoLab.Count())
                    {
                        arrayList.Add(sub1BITSnoLab[l]);
                    }
                    if (l < sub2BITSnoLab.Count())
                    {
                        arrayList.Add(sub2BITSnoLab[l]);
                    }
                    if (l < sub3BITSnoLab.Count())
                    {
                        arrayList.Add(sub3BITSnoLab[l]);
                    }
                    //
                    //BITZ
                    if (l < sub1BITZnoLab.Count())
                    {
                        arrayList.Add(sub1BITZnoLab[l]);
                    }
                    if (l < sub2BITZnoLab.Count())
                    {
                        arrayList.Add(sub2BITZnoLab[l]);
                    }
                    if (l < sub3BITZnoLab.Count())
                    {
                        arrayList.Add(sub3BITZnoLab[l]);
                    }
                    //
                }


                //MessageBox.Show(arrayList.Count.ToString());
                //MessageBox.Show(arrayList[34].ToString());



                for (int j = 0; j < GridView1.Rows.Count; j++)
                {
                    for (int k = 1; k < GridView1.Columns.Count; k++)
                    {
                        //foreach (var item in arrayList)
                        //{
                        //    GridView1.Rows[j].Cells[k].Text = item.ToString() + nl + "Lecturer";
                        //}
                        if (i < arrayList.Count)
                        {

                            //xde data
                            GridView1.Rows[j].Cells[k].Text = arrayList[i].ToString() + nl + "Lecturer";

                            Slot newSlot = new Slot();
                            newSlot.ID = kira.Count() + 1;
                            newSlot.Room_ID = lecturerRooms[rooms].ID;
                            //1dit
                            if (arrayList[i].ToString().Contains("1 DIT"))
                            {
                                newSlot.Course_ID = 1;
                                if (arrayList[i].ToString().Contains("DISCRETE MATHEMATICS"))
                                {
                                    newSlot.Lect_Sub_ID = 253;
                                }
                                else if (arrayList[i].ToString().Contains("WEB PROGRAMMING"))
                                {
                                    newSlot.Lect_Sub_ID = 255;
                                }
                                else if (arrayList[i].ToString().Contains("PROGRAMMING II"))
                                {
                                    newSlot.Lect_Sub_ID = 282;
                                }
                                else if (arrayList[i].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                {
                                    newSlot.Lect_Sub_ID = 259;
                                }
                                else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                {
                                    newSlot.Lect_Sub_ID = 261;
                                }

                            }
                            //2dit
                            else if (arrayList[i].ToString().Contains("2 DIT"))
                            {
                                newSlot.Course_ID = 2;
                                if (arrayList[i].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                {
                                    newSlot.Lect_Sub_ID = 264;
                                }
                                else if (arrayList[i].ToString().Contains("APPLIED STATISTICS"))
                                {
                                    newSlot.Lect_Sub_ID = 266;
                                }
                                else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                {
                                    newSlot.Lect_Sub_ID = 268;
                                }
                                else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                {
                                    newSlot.Lect_Sub_ID = 270;
                                }
                                else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                {
                                    newSlot.Lect_Sub_ID = 272;
                                }
                                else if (arrayList[i].ToString().Contains("DATABASE ADMINISTRATION"))
                                {
                                    newSlot.Lect_Sub_ID = 274;
                                }
                                else if (arrayList[i].ToString().Contains("BASIC NETWORKING"))
                                {
                                    newSlot.Lect_Sub_ID = 276;
                                }
                                else if (arrayList[i].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                {
                                    newSlot.Lect_Sub_ID = 278;
                                }
                            }
                            //bitc
                            else if (arrayList[i].ToString().Contains("1 BITC"))
                            {
                                newSlot.Course_ID = 4;
                                if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                {
                                    newSlot.Lect_Sub_ID = 1;
                                }
                                else if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                {
                                    newSlot.Lect_Sub_ID = 3;
                                }
                                else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                {
                                    newSlot.Lect_Sub_ID = 5;
                                }
                                else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                {
                                    newSlot.Lect_Sub_ID = 7;
                                }
                                else if (arrayList[i].ToString().Contains("DATABASE"))
                                {
                                    newSlot.Lect_Sub_ID = 9;
                                }
                                else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                {
                                    newSlot.Lect_Sub_ID = 11;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("2 BITC"))
                            {
                                newSlot.Course_ID = 5;
                                if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                {
                                    newSlot.Lect_Sub_ID = 18;
                                }
                                else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                {
                                    newSlot.Lect_Sub_ID = 20;
                                }
                                else if (arrayList[i].ToString().Contains("WIDE AREA NETWORK"))
                                {
                                    newSlot.Lect_Sub_ID = 22;
                                }
                                else if (arrayList[i].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                {
                                    newSlot.Lect_Sub_ID = 24;
                                }

                            }
                            else if (arrayList[i].ToString().Contains("3 BITC"))
                            {
                                newSlot.Course_ID = 6;
                                if (arrayList[i].ToString().Contains("INTERNET TECHNOLOGY"))
                                {
                                    newSlot.Lect_Sub_ID = 28;
                                }
                                else if (arrayList[i].ToString().Contains("MULTIMEDIA NETWORKING"))
                                {
                                    newSlot.Lect_Sub_ID = 30;
                                }
                                else if (arrayList[i].ToString().Contains("FIBER OPTIC"))
                                {
                                    newSlot.Lect_Sub_ID = 32;
                                }
                                else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                {
                                    newSlot.Lect_Sub_ID = 34;
                                }
                                else if (arrayList[i].ToString().Contains("TCP/IP PROGRAMMING"))
                                {
                                    newSlot.Lect_Sub_ID = 36;
                                }
                            }
                            //bitd
                            else if (arrayList[i].ToString().Contains("1 BITD"))
                            {
                                newSlot.Course_ID = 7;
                                if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                {
                                    newSlot.Lect_Sub_ID = 39;
                                }
                                else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                {
                                    newSlot.Lect_Sub_ID = 41;
                                }
                                else if (arrayList[i].ToString().Contains("DATABASE"))
                                {
                                    newSlot.Lect_Sub_ID = 43;
                                }
                                else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                {
                                    newSlot.Lect_Sub_ID = 45;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("2 BITD"))
                            {
                                newSlot.Course_ID = 8;
                                if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                {
                                    newSlot.Lect_Sub_ID = 52;
                                }
                                else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                {
                                    newSlot.Lect_Sub_ID = 54;
                                }
                                else if (arrayList[i].ToString().Contains("DATABASE ADMINISTRATION"))
                                {
                                    newSlot.Lect_Sub_ID = 56;
                                }
                                else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                {
                                    newSlot.Lect_Sub_ID = 58;
                                }
                                else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                {
                                    newSlot.Lect_Sub_ID = 60;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("3 BITD"))
                            {
                                newSlot.Course_ID = 9;
                                if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                {
                                    newSlot.Lect_Sub_ID = 64;
                                }
                                else if (arrayList[i].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                {
                                    newSlot.Lect_Sub_ID = 66;
                                }
                                else if (arrayList[i].ToString().Contains("MULTIMEDIA DATABASE"))
                                {
                                    newSlot.Lect_Sub_ID = 68;
                                }
                                else if (arrayList[i].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                {
                                    newSlot.Lect_Sub_ID = 70;
                                }
                            }
                            //bite
                            else if (arrayList[i].ToString().Contains("1 BITE"))
                            {
                                newSlot.Course_ID = 10;
                                if (arrayList[i].ToString().Contains("GAME PROGRAMMING II"))
                                {
                                    newSlot.Lect_Sub_ID = 74;
                                }
                                else if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                {
                                    newSlot.Lect_Sub_ID = 78;
                                }
                                else if (arrayList[i].ToString().Contains("DATABASE"))
                                {
                                    newSlot.Lect_Sub_ID = 80;
                                }

                            }
                            else if (arrayList[i].ToString().Contains("2 BITE"))
                            {
                                newSlot.Course_ID = 11;
                                if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                {
                                    newSlot.Lect_Sub_ID = 85;
                                }
                                else if (arrayList[i].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                {
                                    newSlot.Lect_Sub_ID = 87;
                                }
                                else if (arrayList[i].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                {
                                    newSlot.Lect_Sub_ID = 89;
                                }
                                else if (arrayList[i].ToString().Contains("GAMEPLAY"))
                                {
                                    newSlot.Lect_Sub_ID = 91;
                                }
                                else if (arrayList[i].ToString().Contains("STATISTICS AND PROBABILITY"))
                                {
                                    newSlot.Lect_Sub_ID = 93;
                                }
                                else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                {
                                    newSlot.Lect_Sub_ID = 95;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("3 BITE"))
                            {
                                newSlot.Course_ID = 12;
                                if (arrayList[i].ToString().Contains("3D GAME DEVELOPMENT"))
                                {
                                    newSlot.Lect_Sub_ID = 97;
                                }
                                else if (arrayList[i].ToString().Contains("GAME PHYSICS"))
                                {
                                    newSlot.Lect_Sub_ID = 99;
                                }
                                else if (arrayList[i].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                {
                                    newSlot.Lect_Sub_ID = 101;
                                }
                                else if (arrayList[i].ToString().Contains("GAME MECHANICS"))
                                {
                                    newSlot.Lect_Sub_ID = 103;
                                }
                            }
                            //biti
                            else if (arrayList[i].ToString().Contains("1 BITI"))
                            {
                                newSlot.Course_ID = 13;
                                if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                {
                                    newSlot.Lect_Sub_ID = 106;
                                }
                                else if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                {
                                    newSlot.Lect_Sub_ID = 108;
                                }
                                else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                {
                                    newSlot.Lect_Sub_ID = 110;
                                }
                                else if (arrayList[i].ToString().Contains("DATABASE"))
                                {
                                    newSlot.Lect_Sub_ID = 112;
                                }
                                else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                {
                                    newSlot.Lect_Sub_ID = 114;
                                }
                                else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                {
                                    newSlot.Lect_Sub_ID = 116;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("2 BITI"))
                            {
                                newSlot.Course_ID = 14;
                                if (arrayList[i].ToString().Contains("LOGIC PROGRAMMING"))
                                {
                                    newSlot.Lect_Sub_ID = 123;
                                }
                                else if (arrayList[i].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                {
                                    newSlot.Lect_Sub_ID = 125;
                                }
                                else if (arrayList[i].ToString().Contains("MACHINE LEARNING"))
                                {
                                    newSlot.Lect_Sub_ID = 127;
                                }
                                else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                {
                                    newSlot.Lect_Sub_ID = 129;
                                }
                                else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                {
                                    newSlot.Lect_Sub_ID = 131;
                                }
                                else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                {
                                    newSlot.Lect_Sub_ID = 133;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("3 BITI"))
                            {
                                newSlot.Course_ID = 15;
                                if (arrayList[i].ToString().Contains("INTELLIGENT AGENT"))
                                {
                                    newSlot.Lect_Sub_ID = 137;
                                }
                                else if (arrayList[i].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                {
                                    newSlot.Lect_Sub_ID = 139;
                                }
                                else if (arrayList[i].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                {
                                    newSlot.Lect_Sub_ID = 141;
                                }
                                else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                {
                                    newSlot.Lect_Sub_ID = 143;
                                }
                                else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                {
                                    newSlot.Lect_Sub_ID = 145;
                                }
                            }

                            //bitm
                            else if (arrayList[i].ToString().Contains("1 BITM"))
                            {
                                newSlot.Course_ID = 16;

                                if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                {
                                    newSlot.Lect_Sub_ID = 148;
                                }
                                else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                {
                                    newSlot.Lect_Sub_ID = 152;
                                }
                                else if (arrayList[i].ToString().Contains("DATABASE"))
                                {
                                    newSlot.Lect_Sub_ID = 154;
                                }
                                else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                {
                                    newSlot.Lect_Sub_ID = 156;
                                }
                                else if (arrayList[i].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                {
                                    newSlot.Lect_Sub_ID = 150;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("2 BITM"))
                            {
                                newSlot.Course_ID = 17;
                                if (arrayList[i].ToString().Contains("STATISTICS AND PROBABILITY"))
                                {
                                    newSlot.Lect_Sub_ID = 165;
                                }
                                else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                {
                                    newSlot.Lect_Sub_ID = 167;
                                }
                                else if (arrayList[i].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                {
                                    newSlot.Lect_Sub_ID = 169;
                                }
                                else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                {
                                    newSlot.Lect_Sub_ID = 171;
                                }
                                else if (arrayList[i].ToString().Contains("INTERNET TECHNOLOGY"))
                                {
                                    newSlot.Lect_Sub_ID = 173;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("3 BITM"))
                            {
                                newSlot.Course_ID = 18;
                                if (arrayList[i].ToString().Contains("MOTION GRAPHICS"))
                                {
                                    newSlot.Lect_Sub_ID = 176;
                                }
                                else if (arrayList[i].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                {
                                    newSlot.Lect_Sub_ID = 178;
                                }
                                else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                {
                                    newSlot.Lect_Sub_ID = 180;
                                }
                                else if (arrayList[i].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                {
                                    newSlot.Lect_Sub_ID = 182;
                                }
                                else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                {
                                    newSlot.Lect_Sub_ID = 184;
                                }
                            }
                            //bits
                            else if (arrayList[i].ToString().Contains("1 BITS"))
                            {
                                newSlot.Course_ID = 19;

                                if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                {
                                    newSlot.Lect_Sub_ID = 186;
                                }
                                else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                {
                                    newSlot.Lect_Sub_ID = 188;
                                }
                                else if (arrayList[i].ToString().Contains("DATABASE"))
                                {
                                    newSlot.Lect_Sub_ID = 190;
                                }
                                else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                {
                                    newSlot.Lect_Sub_ID = 192;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("2 BITS"))
                            {
                                newSlot.Course_ID = 20;
                                if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                {
                                    newSlot.Lect_Sub_ID = 199;
                                }
                                else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                {
                                    newSlot.Lect_Sub_ID = 201;
                                }
                                else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                {
                                    newSlot.Lect_Sub_ID = 203;
                                }
                                else if (arrayList[i].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                {
                                    newSlot.Lect_Sub_ID = 205;
                                }
                                else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                {
                                    newSlot.Lect_Sub_ID = 207;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("3 BITS"))
                            {
                                newSlot.Course_ID = 21;
                                if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                {
                                    newSlot.Lect_Sub_ID = 211;
                                }
                                else if (arrayList[i].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                {
                                    newSlot.Lect_Sub_ID = 213;
                                }
                                else if (arrayList[i].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                {
                                    newSlot.Lect_Sub_ID = 215;
                                }
                                else if (arrayList[i].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                {
                                    newSlot.Lect_Sub_ID = 217;
                                }
                            }

                            //bitz
                            else if (arrayList[i].ToString().Contains("1 BITZ"))
                            {
                                newSlot.Course_ID = 22;

                                if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                {
                                    newSlot.Lect_Sub_ID = 220;
                                }
                                else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                {
                                    newSlot.Lect_Sub_ID = 224;
                                }
                                else if (arrayList[i].ToString().Contains("DATABASE"))
                                {
                                    newSlot.Lect_Sub_ID = 226;
                                }
                                else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                {
                                    newSlot.Lect_Sub_ID = 222;
                                }
                                else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                {
                                    newSlot.Lect_Sub_ID = 228;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("2 BITZ"))
                            {
                                newSlot.Course_ID = 23;
                                if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                {
                                    newSlot.Lect_Sub_ID = 233;
                                }
                                else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                {
                                    newSlot.Lect_Sub_ID = 235;
                                }
                                else if (arrayList[i].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                {
                                    newSlot.Lect_Sub_ID = 237;
                                }
                                else if (arrayList[i].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                {
                                    newSlot.Lect_Sub_ID = 239;
                                }
                                else if (arrayList[i].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                {
                                    newSlot.Lect_Sub_ID = 241;
                                }
                            }
                            else if (arrayList[i].ToString().Contains("3 BITZ"))
                            {
                                newSlot.Course_ID = 24;
                                if (arrayList[i].ToString().Contains("DIGITAL FORENSIC"))
                                {
                                    newSlot.Lect_Sub_ID = 243;
                                }
                                else if (arrayList[i].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                {
                                    newSlot.Lect_Sub_ID = 245;
                                }
                                else if (arrayList[i].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                {
                                    newSlot.Lect_Sub_ID = 247;
                                }
                                else if (arrayList[i].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                {
                                    newSlot.Lect_Sub_ID = 249;
                                }
                            }

                            // day
                            if (j == 0)
                            {
                                newSlot.Timetable_ID = 1;
                            }
                            else if (j == 1)
                            {
                                newSlot.Timetable_ID = 2;
                            }
                            else if (j == 2)
                            {
                                newSlot.Timetable_ID = 3;
                            }
                            else if (j == 3)
                            {
                                newSlot.Timetable_ID = 4;
                            }
                            else
                            {
                                newSlot.Timetable_ID = 5;
                            }

                            newSlot.Number = k;
                            ent.Slots.Add(newSlot);
                            ent.SaveChanges();


                        }
                        i++;

                    }

                }


                if (i == 35)
                {
                    rooms += 1;

                    for (int j = 0; j < GridView1.Rows.Count; j++)
                    {
                        for (int k = 1; k < GridView1.Columns.Count; k++)
                        {
                            if (i < arrayList.Count)
                            {
                                //xde data
                                GridView1.Rows[j].Cells[k].Text = arrayList[i].ToString() + nl + "Lecturer";

                                Slot newSlot = new Slot();
                                newSlot.ID = kira.Count() + 1;
                                newSlot.Room_ID = lecturerRooms[rooms].ID;
                                //1dit
                                if (arrayList[i].ToString().Contains("1 DIT"))
                                {
                                    newSlot.Course_ID = 1;
                                    if (arrayList[i].ToString().Contains("DISCRETE MATHEMATICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 253;
                                    }
                                    else if (arrayList[i].ToString().Contains("WEB PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 255;
                                    }
                                    else if (arrayList[i].ToString().Contains("PROGRAMMING II"))
                                    {
                                        newSlot.Lect_Sub_ID = 282;
                                    }
                                    else if (arrayList[i].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 259;
                                    }
                                    else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                    {
                                        newSlot.Lect_Sub_ID = 261;
                                    }

                                }
                                //2dit
                                else if (arrayList[i].ToString().Contains("2 DIT"))
                                {
                                    newSlot.Course_ID = 2;
                                    if (arrayList[i].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 264;
                                    }
                                    else if (arrayList[i].ToString().Contains("APPLIED STATISTICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 266;
                                    }
                                    else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 268;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 270;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 272;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE ADMINISTRATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 274;
                                    }
                                    else if (arrayList[i].ToString().Contains("BASIC NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 276;
                                    }
                                    else if (arrayList[i].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                    {
                                        newSlot.Lect_Sub_ID = 278;
                                    }
                                }
                                //bitc
                                else if (arrayList[i].ToString().Contains("1 BITC"))
                                {
                                    newSlot.Course_ID = 4;
                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 1;
                                    }
                                    else if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 3;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 5;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 7;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 9;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 11;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITC"))
                                {
                                    newSlot.Course_ID = 5;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 18;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 20;
                                    }
                                    else if (arrayList[i].ToString().Contains("WIDE AREA NETWORK"))
                                    {
                                        newSlot.Lect_Sub_ID = 22;
                                    }
                                    else if (arrayList[i].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 24;
                                    }

                                }
                                else if (arrayList[i].ToString().Contains("3 BITC"))
                                {
                                    newSlot.Course_ID = 6;
                                    if (arrayList[i].ToString().Contains("INTERNET TECHNOLOGY"))
                                    {
                                        newSlot.Lect_Sub_ID = 28;
                                    }
                                    else if (arrayList[i].ToString().Contains("MULTIMEDIA NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 30;
                                    }
                                    else if (arrayList[i].ToString().Contains("FIBER OPTIC"))
                                    {
                                        newSlot.Lect_Sub_ID = 32;
                                    }
                                    else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 34;
                                    }
                                    else if (arrayList[i].ToString().Contains("TCP/IP PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 36;
                                    }
                                }
                                //bitd
                                else if (arrayList[i].ToString().Contains("1 BITD"))
                                {
                                    newSlot.Course_ID = 7;
                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 39;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 41;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 43;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 45;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITD"))
                                {
                                    newSlot.Course_ID = 8;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 52;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 54;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE ADMINISTRATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 56;
                                    }
                                    else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 58;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 60;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITD"))
                                {
                                    newSlot.Course_ID = 9;
                                    if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 64;
                                    }
                                    else if (arrayList[i].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                    {
                                        newSlot.Lect_Sub_ID = 66;
                                    }
                                    else if (arrayList[i].ToString().Contains("MULTIMEDIA DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 68;
                                    }
                                    else if (arrayList[i].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 70;
                                    }
                                }
                                //bite
                                else if (arrayList[i].ToString().Contains("1 BITE"))
                                {
                                    newSlot.Course_ID = 10;
                                    if (arrayList[i].ToString().Contains("GAME PROGRAMMING II"))
                                    {
                                        newSlot.Lect_Sub_ID = 74;
                                    }
                                    else if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 78;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 80;
                                    }

                                }
                                else if (arrayList[i].ToString().Contains("2 BITE"))
                                {
                                    newSlot.Course_ID = 11;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                    {
                                        newSlot.Lect_Sub_ID = 85;
                                    }
                                    else if (arrayList[i].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 87;
                                    }
                                    else if (arrayList[i].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                    {
                                        newSlot.Lect_Sub_ID = 89;
                                    }
                                    else if (arrayList[i].ToString().Contains("GAMEPLAY"))
                                    {
                                        newSlot.Lect_Sub_ID = 91;
                                    }
                                    else if (arrayList[i].ToString().Contains("STATISTICS AND PROBABILITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 93;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 95;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITE"))
                                {
                                    newSlot.Course_ID = 12;
                                    if (arrayList[i].ToString().Contains("3D GAME DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 97;
                                    }
                                    else if (arrayList[i].ToString().Contains("GAME PHYSICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 99;
                                    }
                                    else if (arrayList[i].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 101;
                                    }
                                    else if (arrayList[i].ToString().Contains("GAME MECHANICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 103;
                                    }
                                }
                                //biti
                                else if (arrayList[i].ToString().Contains("1 BITI"))
                                {
                                    newSlot.Course_ID = 13;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 106;
                                    }
                                    else if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 108;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 110;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 112;
                                    }
                                    else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                    {
                                        newSlot.Lect_Sub_ID = 114;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 116;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITI"))
                                {
                                    newSlot.Course_ID = 14;
                                    if (arrayList[i].ToString().Contains("LOGIC PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 123;
                                    }
                                    else if (arrayList[i].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                    {
                                        newSlot.Lect_Sub_ID = 125;
                                    }
                                    else if (arrayList[i].ToString().Contains("MACHINE LEARNING"))
                                    {
                                        newSlot.Lect_Sub_ID = 127;
                                    }
                                    else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 129;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 131;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 133;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITI"))
                                {
                                    newSlot.Course_ID = 15;
                                    if (arrayList[i].ToString().Contains("INTELLIGENT AGENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 137;
                                    }
                                    else if (arrayList[i].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                    {
                                        newSlot.Lect_Sub_ID = 139;
                                    }
                                    else if (arrayList[i].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                    {
                                        newSlot.Lect_Sub_ID = 141;
                                    }
                                    else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 143;
                                    }
                                    else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 145;
                                    }
                                }

                                //bitm
                                else if (arrayList[i].ToString().Contains("1 BITM"))
                                {
                                    newSlot.Course_ID = 16;

                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 148;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 152;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 154;
                                    }
                                    else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                    {
                                        newSlot.Lect_Sub_ID = 156;
                                    }
                                    else if (arrayList[i].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                    {
                                        newSlot.Lect_Sub_ID = 150;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITM"))
                                {
                                    newSlot.Course_ID = 17;
                                    if (arrayList[i].ToString().Contains("STATISTICS AND PROBABILITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 165;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 167;
                                    }
                                    else if (arrayList[i].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 169;
                                    }
                                    else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 171;
                                    }
                                    else if (arrayList[i].ToString().Contains("INTERNET TECHNOLOGY"))
                                    {
                                        newSlot.Lect_Sub_ID = 173;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITM"))
                                {
                                    newSlot.Course_ID = 18;
                                    if (arrayList[i].ToString().Contains("MOTION GRAPHICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 176;
                                    }
                                    else if (arrayList[i].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                    {
                                        newSlot.Lect_Sub_ID = 178;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 180;
                                    }
                                    else if (arrayList[i].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 182;
                                    }
                                    else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 184;
                                    }
                                }
                                //bits
                                else if (arrayList[i].ToString().Contains("1 BITS"))
                                {
                                    newSlot.Course_ID = 19;

                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 186;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 188;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 190;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 192;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITS"))
                                {
                                    newSlot.Course_ID = 20;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 199;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 201;
                                    }
                                    else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 203;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 205;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 207;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITS"))
                                {
                                    newSlot.Course_ID = 21;
                                    if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 211;
                                    }
                                    else if (arrayList[i].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                    {
                                        newSlot.Lect_Sub_ID = 213;
                                    }
                                    else if (arrayList[i].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 215;
                                    }
                                    else if (arrayList[i].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 217;
                                    }
                                }

                                //bitz
                                else if (arrayList[i].ToString().Contains("1 BITZ"))
                                {
                                    newSlot.Course_ID = 22;

                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 220;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 224;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 226;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 222;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 228;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITZ"))
                                {
                                    newSlot.Course_ID = 23;
                                    if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 233;
                                    }
                                    else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 235;
                                    }
                                    else if (arrayList[i].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 237;
                                    }
                                    else if (arrayList[i].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 239;
                                    }
                                    else if (arrayList[i].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                    {
                                        newSlot.Lect_Sub_ID = 241;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITZ"))
                                {
                                    newSlot.Course_ID = 24;
                                    if (arrayList[i].ToString().Contains("DIGITAL FORENSIC"))
                                    {
                                        newSlot.Lect_Sub_ID = 243;
                                    }
                                    else if (arrayList[i].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                    {
                                        newSlot.Lect_Sub_ID = 245;
                                    }
                                    else if (arrayList[i].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 247;
                                    }
                                    else if (arrayList[i].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 249;
                                    }
                                }

                                // day
                                if (j == 0)
                                {
                                    newSlot.Timetable_ID = 1;
                                }
                                else if (j == 1)
                                {
                                    newSlot.Timetable_ID = 2;
                                }
                                else if (j == 2)
                                {
                                    newSlot.Timetable_ID = 3;
                                }
                                else if (j == 3)
                                {
                                    newSlot.Timetable_ID = 4;
                                }
                                else
                                {
                                    newSlot.Timetable_ID = 5;
                                }

                                newSlot.Number = k;
                                ent.Slots.Add(newSlot);
                                ent.SaveChanges();
                            }
                            i++;

                        }

                    }
                }

                if (i == 70)
                {
                    rooms += 1;

                    for (int j = 0; j < GridView1.Rows.Count; j++)
                    {
                        for (int k = 1; k < GridView1.Columns.Count; k++)
                        {
                            if (i < arrayList.Count)
                            {

                                //xde data
                                GridView1.Rows[j].Cells[k].Text = arrayList[i].ToString() + nl + "Lecturer";

                                Slot newSlot = new Slot();
                                newSlot.ID = kira.Count() + 1;
                                newSlot.Room_ID = lecturerRooms[rooms].ID;
                                //1dit
                                if (arrayList[i].ToString().Contains("1 DIT"))
                                {
                                    newSlot.Course_ID = 1;
                                    if (arrayList[i].ToString().Contains("DISCRETE MATHEMATICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 253;
                                    }
                                    else if (arrayList[i].ToString().Contains("WEB PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 255;
                                    }
                                    else if (arrayList[i].ToString().Contains("PROGRAMMING II"))
                                    {
                                        newSlot.Lect_Sub_ID = 282;
                                    }
                                    else if (arrayList[i].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 259;
                                    }
                                    else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                    {
                                        newSlot.Lect_Sub_ID = 261;
                                    }

                                }
                                //2dit
                                else if (arrayList[i].ToString().Contains("2 DIT"))
                                {
                                    newSlot.Course_ID = 2;
                                    if (arrayList[i].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 264;
                                    }
                                    else if (arrayList[i].ToString().Contains("APPLIED STATISTICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 266;
                                    }
                                    else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 268;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 270;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 272;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE ADMINISTRATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 274;
                                    }
                                    else if (arrayList[i].ToString().Contains("BASIC NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 276;
                                    }
                                    else if (arrayList[i].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                    {
                                        newSlot.Lect_Sub_ID = 278;
                                    }
                                }
                                //bitc
                                else if (arrayList[i].ToString().Contains("1 BITC"))
                                {
                                    newSlot.Course_ID = 4;
                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 1;
                                    }
                                    else if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 3;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 5;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 7;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 9;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 11;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITC"))
                                {
                                    newSlot.Course_ID = 5;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 18;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 20;
                                    }
                                    else if (arrayList[i].ToString().Contains("WIDE AREA NETWORK"))
                                    {
                                        newSlot.Lect_Sub_ID = 22;
                                    }
                                    else if (arrayList[i].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 24;
                                    }

                                }
                                else if (arrayList[i].ToString().Contains("3 BITC"))
                                {
                                    newSlot.Course_ID = 6;
                                    if (arrayList[i].ToString().Contains("INTERNET TECHNOLOGY"))
                                    {
                                        newSlot.Lect_Sub_ID = 28;
                                    }
                                    else if (arrayList[i].ToString().Contains("MULTIMEDIA NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 30;
                                    }
                                    else if (arrayList[i].ToString().Contains("FIBER OPTIC"))
                                    {
                                        newSlot.Lect_Sub_ID = 32;
                                    }
                                    else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 34;
                                    }
                                    else if (arrayList[i].ToString().Contains("TCP/IP PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 36;
                                    }
                                }
                                //bitd
                                else if (arrayList[i].ToString().Contains("1 BITD"))
                                {
                                    newSlot.Course_ID = 7;
                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 39;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 41;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 43;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 45;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITD"))
                                {
                                    newSlot.Course_ID = 8;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 52;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 54;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE ADMINISTRATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 56;
                                    }
                                    else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 58;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 60;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITD"))
                                {
                                    newSlot.Course_ID = 9;
                                    if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 64;
                                    }
                                    else if (arrayList[i].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                    {
                                        newSlot.Lect_Sub_ID = 66;
                                    }
                                    else if (arrayList[i].ToString().Contains("MULTIMEDIA DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 68;
                                    }
                                    else if (arrayList[i].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 70;
                                    }
                                }
                                //bite
                                else if (arrayList[i].ToString().Contains("1 BITE"))
                                {
                                    newSlot.Course_ID = 10;
                                    if (arrayList[i].ToString().Contains("GAME PROGRAMMING II"))
                                    {
                                        newSlot.Lect_Sub_ID = 74;
                                    }
                                    else if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 78;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 80;
                                    }

                                }
                                else if (arrayList[i].ToString().Contains("2 BITE"))
                                {
                                    newSlot.Course_ID = 11;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                    {
                                        newSlot.Lect_Sub_ID = 85;
                                    }
                                    else if (arrayList[i].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 87;
                                    }
                                    else if (arrayList[i].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                    {
                                        newSlot.Lect_Sub_ID = 89;
                                    }
                                    else if (arrayList[i].ToString().Contains("GAMEPLAY"))
                                    {
                                        newSlot.Lect_Sub_ID = 91;
                                    }
                                    else if (arrayList[i].ToString().Contains("STATISTICS AND PROBABILITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 93;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 95;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITE"))
                                {
                                    newSlot.Course_ID = 12;
                                    if (arrayList[i].ToString().Contains("3D GAME DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 97;
                                    }
                                    else if (arrayList[i].ToString().Contains("GAME PHYSICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 99;
                                    }
                                    else if (arrayList[i].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 101;
                                    }
                                    else if (arrayList[i].ToString().Contains("GAME MECHANICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 103;
                                    }
                                }
                                //biti
                                else if (arrayList[i].ToString().Contains("1 BITI"))
                                {
                                    newSlot.Course_ID = 13;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 106;
                                    }
                                    else if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 108;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 110;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 112;
                                    }
                                    else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                    {
                                        newSlot.Lect_Sub_ID = 114;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 116;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITI"))
                                {
                                    newSlot.Course_ID = 14;
                                    if (arrayList[i].ToString().Contains("LOGIC PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 123;
                                    }
                                    else if (arrayList[i].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                    {
                                        newSlot.Lect_Sub_ID = 125;
                                    }
                                    else if (arrayList[i].ToString().Contains("MACHINE LEARNING"))
                                    {
                                        newSlot.Lect_Sub_ID = 127;
                                    }
                                    else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 129;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 131;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 133;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITI"))
                                {
                                    newSlot.Course_ID = 15;
                                    if (arrayList[i].ToString().Contains("INTELLIGENT AGENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 137;
                                    }
                                    else if (arrayList[i].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                    {
                                        newSlot.Lect_Sub_ID = 139;
                                    }
                                    else if (arrayList[i].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                    {
                                        newSlot.Lect_Sub_ID = 141;
                                    }
                                    else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 143;
                                    }
                                    else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 145;
                                    }
                                }

                                //bitm
                                else if (arrayList[i].ToString().Contains("1 BITM"))
                                {
                                    newSlot.Course_ID = 16;

                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 148;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 152;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 154;
                                    }
                                    else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                    {
                                        newSlot.Lect_Sub_ID = 156;
                                    }
                                    else if (arrayList[i].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                    {
                                        newSlot.Lect_Sub_ID = 150;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITM"))
                                {
                                    newSlot.Course_ID = 17;
                                    if (arrayList[i].ToString().Contains("STATISTICS AND PROBABILITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 165;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 167;
                                    }
                                    else if (arrayList[i].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 169;
                                    }
                                    else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 171;
                                    }
                                    else if (arrayList[i].ToString().Contains("INTERNET TECHNOLOGY"))
                                    {
                                        newSlot.Lect_Sub_ID = 173;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITM"))
                                {
                                    newSlot.Course_ID = 18;
                                    if (arrayList[i].ToString().Contains("MOTION GRAPHICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 176;
                                    }
                                    else if (arrayList[i].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                    {
                                        newSlot.Lect_Sub_ID = 178;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 180;
                                    }
                                    else if (arrayList[i].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 182;
                                    }
                                    else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                    {
                                        newSlot.Lect_Sub_ID = 184;
                                    }
                                }
                                //bits
                                else if (arrayList[i].ToString().Contains("1 BITS"))
                                {
                                    newSlot.Course_ID = 19;

                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 186;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 188;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 190;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 192;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITS"))
                                {
                                    newSlot.Course_ID = 20;
                                    if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 199;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 201;
                                    }
                                    else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 203;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 205;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 207;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITS"))
                                {
                                    newSlot.Course_ID = 21;
                                    if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 211;
                                    }
                                    else if (arrayList[i].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                    {
                                        newSlot.Lect_Sub_ID = 213;
                                    }
                                    else if (arrayList[i].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 215;
                                    }
                                    else if (arrayList[i].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 217;
                                    }
                                }

                                //bitz
                                else if (arrayList[i].ToString().Contains("1 BITZ"))
                                {
                                    newSlot.Course_ID = 22;

                                    if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 220;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 224;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE"))
                                    {
                                        newSlot.Lect_Sub_ID = 226;
                                    }
                                    else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 222;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 228;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("2 BITZ"))
                                {
                                    newSlot.Course_ID = 23;
                                    if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 233;
                                    }
                                    else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    {
                                        newSlot.Lect_Sub_ID = 235;
                                    }
                                    else if (arrayList[i].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                    {
                                        newSlot.Lect_Sub_ID = 237;
                                    }
                                    else if (arrayList[i].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 239;
                                    }
                                    else if (arrayList[i].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                    {
                                        newSlot.Lect_Sub_ID = 241;
                                    }
                                }
                                else if (arrayList[i].ToString().Contains("3 BITZ"))
                                {
                                    newSlot.Course_ID = 24;
                                    if (arrayList[i].ToString().Contains("DIGITAL FORENSIC"))
                                    {
                                        newSlot.Lect_Sub_ID = 243;
                                    }
                                    else if (arrayList[i].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                    {
                                        newSlot.Lect_Sub_ID = 245;
                                    }
                                    else if (arrayList[i].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                    {
                                        newSlot.Lect_Sub_ID = 247;
                                    }
                                    else if (arrayList[i].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                    {
                                        newSlot.Lect_Sub_ID = 249;
                                    }
                                }

                                // day
                                if (j == 0)
                                {
                                    newSlot.Timetable_ID = 1;
                                }
                                else if (j == 1)
                                {
                                    newSlot.Timetable_ID = 2;
                                }
                                else if (j == 2)
                                {
                                    newSlot.Timetable_ID = 3;
                                }
                                else if (j == 3)
                                {
                                    newSlot.Timetable_ID = 4;
                                }
                                else
                                {
                                    newSlot.Timetable_ID = 5;
                                }

                                newSlot.Number = k;
                                ent.Slots.Add(newSlot);
                                ent.SaveChanges();



                            }
                            i++;

                        }

                    }
                }


                if (i == 105)
                {
                    rooms += 1;
                    var slots = ent.Slots.ToList();
                    for (int j = 0; j < GridView1.Rows.Count; j++)
                    {
                        for (int k = 1; k < GridView1.Columns.Count; k++)
                        {
                            if (i < arrayList.Count)
                            {
                                if (arrayList[i].ToString().Contains("2 DIT"))
                                {
                                    k = k + 1;
                                    Slot newSlot = new Slot();
                                    newSlot.ID = kira.Count() + 1;
                                    newSlot.Room_ID = lecturerRooms[rooms].ID;
                                    newSlot.Course_ID = 2;

                                    if (arrayList[i].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                    {
                                        newSlot.Lect_Sub_ID = 264;
                                    }
                                    else if (arrayList[i].ToString().Contains("APPLIED STATISTICS"))
                                    {
                                        newSlot.Lect_Sub_ID = 266;
                                    }
                                    else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    {
                                        newSlot.Lect_Sub_ID = 268;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    {
                                        newSlot.Lect_Sub_ID = 270;
                                    }
                                    else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                    {
                                        newSlot.Lect_Sub_ID = 272;
                                    }
                                    else if (arrayList[i].ToString().Contains("DATABASE ADMINISTRATION"))
                                    {
                                        newSlot.Lect_Sub_ID = 274;
                                    }
                                    else if (arrayList[i].ToString().Contains("BASIC NETWORKING"))
                                    {
                                        newSlot.Lect_Sub_ID = 276;
                                    }
                                    else if (arrayList[i].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                    {
                                        newSlot.Lect_Sub_ID = 278;
                                    }
                                    if (j == 0)
                                    {
                                        newSlot.Timetable_ID = 1;
                                    }
                                    else if (j == 1)
                                    {
                                        newSlot.Timetable_ID = 2;
                                    }
                                    else if (j == 2)
                                    {
                                        newSlot.Timetable_ID = 3;
                                    }
                                    else if (j == 3)
                                    {
                                        newSlot.Timetable_ID = 4;
                                    }
                                    else
                                    {
                                        newSlot.Timetable_ID = 5;
                                    }

                                    newSlot.Number = k;
                                    ent.Slots.Add(newSlot);
                                    ent.SaveChanges();
                                }

                                else
                                {
                                    //MessageBox.Show("HSHAHAHSd");

                                    //MessageBox.Show("Test");
                                    //xde data
                                    GridView1.Rows[j].Cells[k].Text = arrayList[i].ToString() + nl + "Lecturer";

                                    Slot newSlot = new Slot();
                                    newSlot.ID = kira.Count() + 1;
                                    newSlot.Room_ID = lecturerRooms[rooms].ID;
                                    //1dit
                                    if (arrayList[i].ToString().Contains("1 DIT"))
                                    {
                                        newSlot.Course_ID = 1;
                                        if (arrayList[i].ToString().Contains("DISCRETE MATHEMATICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 253;
                                        }
                                        else if (arrayList[i].ToString().Contains("WEB PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 255;
                                        }
                                        else if (arrayList[i].ToString().Contains("PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 282;
                                        }
                                        else if (arrayList[i].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 259;
                                        }
                                        else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 261;
                                        }

                                    }
                                    //2dit
                                    else if (arrayList[i].ToString().Contains("2 DIT"))
                                    {
                                        newSlot.Course_ID = 2;
                                        if (arrayList[i].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 264;
                                        }
                                        else if (arrayList[i].ToString().Contains("APPLIED STATISTICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 266;
                                        }
                                        else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 268;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 270;
                                        }
                                        else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 272;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 274;
                                        }
                                        else if (arrayList[i].ToString().Contains("BASIC NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 276;
                                        }
                                        else if (arrayList[i].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        {
                                            newSlot.Lect_Sub_ID = 278;
                                        }
                                    }
                                    //bitc
                                    else if (arrayList[i].ToString().Contains("1 BITC"))
                                    {
                                        newSlot.Course_ID = 4;
                                        if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 1;
                                        }
                                        else if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 3;
                                        }
                                        else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 5;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 7;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 9;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 11;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("2 BITC"))
                                    {
                                        newSlot.Course_ID = 5;
                                        if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 18;
                                        }
                                        else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 20;
                                        }
                                        else if (arrayList[i].ToString().Contains("WIDE AREA NETWORK"))
                                        {
                                            newSlot.Lect_Sub_ID = 22;
                                        }
                                        else if (arrayList[i].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 24;
                                        }

                                    }
                                    else if (arrayList[i].ToString().Contains("3 BITC"))
                                    {
                                        newSlot.Course_ID = 6;
                                        if (arrayList[i].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 28;
                                        }
                                        else if (arrayList[i].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 30;
                                        }
                                        else if (arrayList[i].ToString().Contains("FIBER OPTIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 32;
                                        }
                                        else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 34;
                                        }
                                        else if (arrayList[i].ToString().Contains("TCP/IP PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 36;
                                        }
                                    }
                                    //bitd
                                    else if (arrayList[i].ToString().Contains("1 BITD"))
                                    {
                                        newSlot.Course_ID = 7;
                                        if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 39;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 41;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 43;
                                        }
                                        else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 45;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("2 BITD"))
                                    {
                                        newSlot.Course_ID = 8;
                                        if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 52;
                                        }
                                        else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 54;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 56;
                                        }
                                        else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 58;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 60;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("3 BITD"))
                                    {
                                        newSlot.Course_ID = 9;
                                        if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 64;
                                        }
                                        else if (arrayList[i].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 66;
                                        }
                                        else if (arrayList[i].ToString().Contains("MULTIMEDIA DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 68;
                                        }
                                        else if (arrayList[i].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 70;
                                        }
                                    }
                                    //bite
                                    else if (arrayList[i].ToString().Contains("1 BITE"))
                                    {
                                        newSlot.Course_ID = 10;
                                        if (arrayList[i].ToString().Contains("GAME PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 74;
                                        }
                                        else if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 78;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 80;
                                        }

                                    }
                                    else if (arrayList[i].ToString().Contains("2 BITE"))
                                    {
                                        newSlot.Course_ID = 11;
                                        if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        {
                                            newSlot.Lect_Sub_ID = 85;
                                        }
                                        else if (arrayList[i].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 87;
                                        }
                                        else if (arrayList[i].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        {
                                            newSlot.Lect_Sub_ID = 89;
                                        }
                                        else if (arrayList[i].ToString().Contains("GAMEPLAY"))
                                        {
                                            newSlot.Lect_Sub_ID = 91;
                                        }
                                        else if (arrayList[i].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 93;
                                        }
                                        else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 95;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("3 BITE"))
                                    {
                                        newSlot.Course_ID = 12;
                                        if (arrayList[i].ToString().Contains("3D GAME DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 97;
                                        }
                                        else if (arrayList[i].ToString().Contains("GAME PHYSICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 99;
                                        }
                                        else if (arrayList[i].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 101;
                                        }
                                        else if (arrayList[i].ToString().Contains("GAME MECHANICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 103;
                                        }
                                    }
                                    //biti
                                    else if (arrayList[i].ToString().Contains("1 BITI"))
                                    {
                                        newSlot.Course_ID = 13;
                                        if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 106;
                                        }
                                        else if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 108;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 110;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 112;
                                        }
                                        else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 114;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 116;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("2 BITI"))
                                    {
                                        newSlot.Course_ID = 14;
                                        if (arrayList[i].ToString().Contains("LOGIC PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 123;
                                        }
                                        else if (arrayList[i].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 125;
                                        }
                                        else if (arrayList[i].ToString().Contains("MACHINE LEARNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 127;
                                        }
                                        else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 129;
                                        }
                                        else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 131;
                                        }
                                        else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 133;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("3 BITI"))
                                    {
                                        newSlot.Course_ID = 15;
                                        if (arrayList[i].ToString().Contains("INTELLIGENT AGENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 137;
                                        }
                                        else if (arrayList[i].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        {
                                            newSlot.Lect_Sub_ID = 139;
                                        }
                                        else if (arrayList[i].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        {
                                            newSlot.Lect_Sub_ID = 141;
                                        }
                                        else if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 143;
                                        }
                                        else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 145;
                                        }
                                    }

                                    //bitm
                                    else if (arrayList[i].ToString().Contains("1 BITM"))
                                    {
                                        newSlot.Course_ID = 16;

                                        if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 148;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 152;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 154;
                                        }
                                        else if (arrayList[i].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 156;
                                        }
                                        else if (arrayList[i].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        {
                                            newSlot.Lect_Sub_ID = 150;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("2 BITM"))
                                    {
                                        newSlot.Course_ID = 17;
                                        if (arrayList[i].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 165;
                                        }
                                        else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 167;
                                        }
                                        else if (arrayList[i].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 169;
                                        }
                                        else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 171;
                                        }
                                        else if (arrayList[i].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 173;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("3 BITM"))
                                    {
                                        newSlot.Course_ID = 18;
                                        if (arrayList[i].ToString().Contains("MOTION GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 176;
                                        }
                                        else if (arrayList[i].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 178;
                                        }
                                        else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 180;
                                        }
                                        else if (arrayList[i].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 182;
                                        }
                                        else if (arrayList[i].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 184;
                                        }
                                    }
                                    //bits
                                    else if (arrayList[i].ToString().Contains("1 BITS"))
                                    {
                                        newSlot.Course_ID = 19;

                                        if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 186;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 188;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 190;
                                        }
                                        else if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 192;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("2 BITS"))
                                    {
                                        newSlot.Course_ID = 20;
                                        if (arrayList[i].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 199;
                                        }
                                        else if (arrayList[i].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 201;
                                        }
                                        else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 203;
                                        }
                                        else if (arrayList[i].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 205;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 207;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("3 BITS"))
                                    {
                                        newSlot.Course_ID = 21;
                                        if (arrayList[i].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 211;
                                        }
                                        else if (arrayList[i].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 213;
                                        }
                                        else if (arrayList[i].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 215;
                                        }
                                        else if (arrayList[i].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 217;
                                        }
                                    }

                                    //bitz
                                    else if (arrayList[i].ToString().Contains("1 BITZ"))
                                    {
                                        newSlot.Course_ID = 22;

                                        if (arrayList[i].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 220;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 224;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 226;
                                        }
                                        else if (arrayList[i].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 222;
                                        }
                                        else if (arrayList[i].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 228;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("2 BITZ"))
                                    {
                                        newSlot.Course_ID = 23;
                                        if (arrayList[i].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 233;
                                        }
                                        else if (arrayList[i].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 235;
                                        }
                                        else if (arrayList[i].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 237;
                                        }
                                        else if (arrayList[i].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 239;
                                        }
                                        else if (arrayList[i].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        {
                                            newSlot.Lect_Sub_ID = 241;
                                        }
                                    }
                                    else if (arrayList[i].ToString().Contains("3 BITZ"))
                                    {
                                        newSlot.Course_ID = 24;
                                        if (arrayList[i].ToString().Contains("DIGITAL FORENSIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 243;
                                        }
                                        else if (arrayList[i].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        {
                                            newSlot.Lect_Sub_ID = 245;
                                        }
                                        else if (arrayList[i].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 247;
                                        }
                                        else if (arrayList[i].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 249;
                                        }
                                    }

                                    // day
                                    if (j == 0)
                                    {
                                        newSlot.Timetable_ID = 1;
                                    }
                                    else if (j == 1)
                                    {
                                        newSlot.Timetable_ID = 2;
                                    }
                                    else if (j == 2)
                                    {
                                        newSlot.Timetable_ID = 3;
                                    }
                                    else if (j == 3)
                                    {
                                        newSlot.Timetable_ID = 4;
                                    }
                                    else
                                    {
                                        newSlot.Timetable_ID = 5;
                                    }

                                    newSlot.Number = k;
                                    ent.Slots.Add(newSlot);
                                    ent.SaveChanges();



                                }

                            }
                            i++;
                        }
                    }
                }


                MessageBox.Show("Success data has been inserted !", "Success", MessageBoxButtons.OK, MessageBoxIcon.Information);
                Button1.Enabled = false;
                Button4.Enabled = true;
                Button5.Enabled = true;
                
            }
        }

        protected void Button2_Click(object sender, EventArgs e)
        {

            if (MessageBox.Show("Do you want to generate timetable for all course", "Warning", MessageBoxButtons.YesNo, MessageBoxIcon.Warning) == DialogResult.Yes)
            {

                // all labs
                var roomLab = ent.Rooms.Where(x => x.Type_ID == 2).ToList().ToArray();
                int rangelab = rnd.Next(roomLab.Count());
                int rangelab2 = rnd.Next(roomLab.Count());
                int rangelab3 = rnd.Next(roomLab.Count());
                //MessageBox.Show(rangelab + "," + rangelab2);
                var labroom = roomLab[rangelab];
                var labroom2 = roomLab[rangelab2];
                var labroom3 = roomLab[rangelab3];

                //DIT
                var sub1DITLab = ent.View_1DIT.Where(x => x.Name.Contains("1 DIT") && x.CodeName.StartsWith("DIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2DITLab = ent.View_1DIT.Where(x => x.Name.Contains("2 DIT") && x.CodeName.StartsWith("DIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITC
                var sub1BITCLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITC") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITCLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITC") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITCLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITC") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITD
                var sub1BITDLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITD") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITDLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITD") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITDLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITD") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITE
                var sub1BITELab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITE") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITELab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITE") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITELab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITE") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITI
                var sub1BITILab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITI") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITILab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITI") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITILab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITI") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITM
                var sub1BITMLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITM") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITMLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITM") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITMLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITM") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITS
                var sub1BITSLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITS") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITSLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITS") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITSLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITS") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITZ
                var sub1BITZLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITZ") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITZLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITZ") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITZLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITZ") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                ArrayList arrayLab = new ArrayList();

                for (int l = 0; l < sub2DITLab.Count(); l++)
                {
                    //BITZ
                    if (l < sub3BITZLab.Count())
                    {
                        arrayLab.Add(sub3BITZLab[l]);
                    }
                    if (l < sub2BITZLab.Count())
                    {
                        arrayLab.Add(sub2BITZLab[l]);
                    }
                    if (l < sub1BITZLab.Count())
                    {
                        arrayLab.Add(sub1BITZLab[l]);
                    }

                    //BITS
                    if (l < sub3BITSLab.Count())
                    {
                        arrayLab.Add(sub3BITSLab[l]);
                    }
                    if (l < sub2BITSLab.Count())
                    {
                        arrayLab.Add(sub2BITSLab[l]);
                    }
                    if (l < sub1BITSLab.Count())
                    {
                        arrayLab.Add(sub1BITSLab[l]);
                    }

                    //BITM
                    if (l < sub3BITMLab.Count())
                    {
                        arrayLab.Add(sub3BITMLab[l]);
                    }
                    if (l < sub2BITMLab.Count())
                    {
                        arrayLab.Add(sub2BITMLab[l]);
                    }
                    if (l < sub1BITMLab.Count())
                    {
                        arrayLab.Add(sub1BITMLab[l]);
                    }

                    //BITI
                    if (l < sub3BITILab.Count())
                    {
                        arrayLab.Add(sub3BITILab[l]);
                    }
                    if (l < sub2BITILab.Count())
                    {
                        arrayLab.Add(sub2BITILab[l]);
                    }
                    if (l < sub1BITILab.Count())
                    {
                        arrayLab.Add(sub1BITILab[l]);
                    }

                    //BITE
                    if (l < sub3BITELab.Count())
                    {
                        arrayLab.Add(sub3BITELab[l]);
                    }
                    if (l < sub2BITELab.Count())
                    {
                        arrayLab.Add(sub2BITELab[l]);
                    }
                    if (l < sub1BITELab.Count())
                    {
                        arrayLab.Add(sub1BITELab[l]);
                    }

                    //BITD
                    if (l < sub3BITDLab.Count())
                    {
                        arrayLab.Add(sub3BITDLab[l]);
                    }
                    if (l < sub2BITDLab.Count())
                    {
                        arrayLab.Add(sub2BITDLab[l]);
                    }
                    if (l < sub1BITDLab.Count())
                    {
                        arrayLab.Add(sub1BITDLab[l]);
                    }

                    //BITC
                    if (l < sub3BITCLab.Count())
                    {
                        arrayLab.Add(sub3BITCLab[l]);
                    }
                    if (l < sub2BITCLab.Count())
                    {
                        arrayLab.Add(sub2BITCLab[l]);
                    }
                    if (l < sub1BITCLab.Count())
                    {
                        arrayLab.Add(sub1BITCLab[l]);
                    }

                    //DIT
                    if (l < sub1DITLab.Count())
                    {
                        arrayLab.Add(sub1DITLab[l]);
                    }
                    if (l < sub2DITLab.Count())
                    {
                        arrayLab.Add(sub2DITLab[l]);
                    }


                }

                var kira = ent.Slots.ToList();
                var slots2 = ent.Slots.ToList();
                int p = 0;
                //MessageBox.Show(slots2.Count().ToString());
                for (int j = 0; j < GridView1.Rows.Count; j++)
                {
                    for (int k = 1; k < GridView1.Columns.Count; k++)
                    {
                        if (p < arrayLab.Count)
                        {
                            // 3 bitz
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 24))
                            {
                                //MessageBox.Show("Test");
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("3 BITZ"))
                                {
                                    //MessageBox.Show("asdas");
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 24;
                                        if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 244;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        {
                                            newSlot.Lect_Sub_ID = 246;
                                        }
                                        else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 248;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 250;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 24;
                                        if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 244;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        {
                                            newSlot.Lect_Sub_ID = 246;
                                        }
                                        else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 248;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 250;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 24))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITZ"))
                                {
                                    //MessageBox.Show("HAHAH");

                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 24;
                                        if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 244;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        {
                                            newSlot.Lect_Sub_ID = 246;
                                        }
                                        else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 248;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 250;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 24;
                                    //    if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 244;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 246;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 248;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 250;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);

                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 24;
                                        if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 244;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        {
                                            newSlot.Lect_Sub_ID = 246;
                                        }
                                        else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 248;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 250;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }



                                }
                            }


                            // 2 bitz
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 23))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITZ"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 23;
                                        if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 234;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 236;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 238;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 240;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        {
                                            newSlot.Lect_Sub_ID = 242;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 23;
                                        if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 234;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 236;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 238;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 240;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        {
                                            newSlot.Lect_Sub_ID = 242;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 23))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITZ"))
                                {
                                    //MessageBox.Show("HAHAH");

                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 23;
                                        if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 234;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 236;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 238;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 240;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        {
                                            newSlot.Lect_Sub_ID = 242;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 23;
                                    //    if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 234;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 236;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 238;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 240;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 242;
                                    //    }
                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }
                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 23;
                                        if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 234;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 236;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 238;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 240;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        {
                                            newSlot.Lect_Sub_ID = 242;
                                        }
                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }
                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }



                                }
                            }

                            // 1 bitz
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 22))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITZ"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 22;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 221;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 225;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 227;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 223;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 229;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 22;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 221;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 225;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 227;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 223;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 229;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                }


                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 22))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITZ"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 22;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 221;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 225;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 227;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 223;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 229;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{

                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 22;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 221;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 225;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 227;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 223;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 229;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 22;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 221;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 225;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 227;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 223;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 229;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 3 bits
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 21))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITS"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 21;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 212;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 214;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 216;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 218;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 21;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 212;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 214;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 216;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 218;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 21))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("3 BITS"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 21;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 212;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 214;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 216;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 218;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{

                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 21;

                                    //    if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 212;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 214;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 216;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 218;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 21;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 212;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 214;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 216;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 218;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 2 bits
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 20))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITS"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 20;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 200;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 202;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 204;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 206;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 208;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 20;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 200;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 202;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 204;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 206;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 208;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 20))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITS"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 20;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 200;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 202;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 204;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 206;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 208;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{

                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 20;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 200;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 202;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 204;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 206;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 208;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 20;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 200;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 202;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 204;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 206;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 208;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 bits
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 19))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITS"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 19;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 187;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 189;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 191;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 193;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 19;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 187;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 189;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 191;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 193;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }


                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 19))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITS"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 19;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 187;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 189;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 191;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 193;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 19;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 187;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 189;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 191;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 193;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 19;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 187;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 189;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 191;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 193;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }


                            // 3 bitm
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 18))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITM"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 18;

                                        if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 177;
                                        }
                                        else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 179;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 181;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 183;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 185;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 18;

                                        if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 177;
                                        }
                                        else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 179;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 181;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 183;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 185;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 18))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITM"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 18;

                                        if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 177;
                                        }
                                        else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 179;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 181;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 183;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 185;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 18;

                                    //    if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 177;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 179;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 181;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 183;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 185;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 18;

                                        if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 177;
                                        }
                                        else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 179;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 181;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 183;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 185;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }


                            // 2 bitm
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 17))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITM"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 17;

                                        if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 166;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 168;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 170;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 172;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 174;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 17;

                                        if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 166;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 168;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 170;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 172;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 174;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 17))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITM"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 17;

                                        if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 166;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 168;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 170;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 172;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 174;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 17;

                                    //    if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 166;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 168;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 170;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 172;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 174;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 17;

                                        if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 166;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 168;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 170;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 172;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 174;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 bitm
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 16))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITM"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 16;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 149;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 153;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 155;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 157;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        {
                                            newSlot.Lect_Sub_ID = 151;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 16;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 149;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 153;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 155;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 157;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        {
                                            newSlot.Lect_Sub_ID = 151;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 16))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITM"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 16;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 149;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 153;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 155;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 157;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        {
                                            newSlot.Lect_Sub_ID = 151;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 16;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 149;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 153;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 155;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 157;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 151;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 16;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 149;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 153;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 155;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 157;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        {
                                            newSlot.Lect_Sub_ID = 151;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 3 biti
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 15))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITI"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 15;

                                        if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 138;
                                        }
                                        else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        {
                                            newSlot.Lect_Sub_ID = 140;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        {
                                            newSlot.Lect_Sub_ID = 142;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 144;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 146;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 15;

                                        if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 138;
                                        }
                                        else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        {
                                            newSlot.Lect_Sub_ID = 140;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        {
                                            newSlot.Lect_Sub_ID = 142;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 144;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 146;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 15))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITI"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 15;

                                        if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 138;
                                        }
                                        else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        {
                                            newSlot.Lect_Sub_ID = 140;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        {
                                            newSlot.Lect_Sub_ID = 142;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 144;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 146;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 15;

                                    //    if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 138;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 140;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 142;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 144;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 146;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 15;

                                        if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 138;
                                        }
                                        else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        {
                                            newSlot.Lect_Sub_ID = 140;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        {
                                            newSlot.Lect_Sub_ID = 142;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 144;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 146;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 2 biti
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 14))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITI"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 14;

                                        if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 124;
                                        }
                                        else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 126;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 128;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 130;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 132;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 134;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 14;

                                        if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 124;
                                        }
                                        else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 126;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 128;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 130;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 132;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 134;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 14))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITI"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 14;

                                        if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 124;
                                        }
                                        else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 126;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 128;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 130;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 132;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 134;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 14;

                                    //    if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 124;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 126;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 128;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 130;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 132;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 134;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 14;

                                        if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 124;
                                        }
                                        else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 126;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 128;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 130;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 132;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 134;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 biti
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 13))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITI"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 13;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 107;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 109;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 111;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 113;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 115;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 117;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 13;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 107;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 109;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 111;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 113;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 115;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 117;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 13))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITI"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        //MessageBox.Show("Test !slot");
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 13;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 107;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 109;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 111;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 113;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 115;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 117;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    MessageBox.Show("Test !slot2");
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 13;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 107;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 109;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 111;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 113;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 115;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 117;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        //MessageBox.Show("Test !slot3");
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 13;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 107;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 109;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 111;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 113;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 115;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 117;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 3 bite
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 12))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("3 BITE"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {

                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 12;

                                        if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 98;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 100;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 102;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 104;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 12;

                                        if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 98;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 100;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 102;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 104;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 12))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITE"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 12;

                                        if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 98;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 100;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 102;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 104;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 12;

                                    //    if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 98;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 100;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 102;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 104;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 12;

                                        if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 98;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 100;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 102;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 104;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }


                            // 2 bite
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 11))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITE"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 11;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        {
                                            newSlot.Lect_Sub_ID = 86;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 88;
                                        }
                                        else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        {
                                            newSlot.Lect_Sub_ID = 90;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        {
                                            newSlot.Lect_Sub_ID = 92;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 94;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 96;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 11;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        {
                                            newSlot.Lect_Sub_ID = 86;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 88;
                                        }
                                        else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        {
                                            newSlot.Lect_Sub_ID = 90;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        {
                                            newSlot.Lect_Sub_ID = 92;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 94;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 96;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 11))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITE"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 11;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        {
                                            newSlot.Lect_Sub_ID = 86;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 88;
                                        }
                                        else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        {
                                            newSlot.Lect_Sub_ID = 90;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        {
                                            newSlot.Lect_Sub_ID = 92;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 94;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 96;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 11;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 86;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 88;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 90;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 92;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 94;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 96;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 11;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        {
                                            newSlot.Lect_Sub_ID = 86;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 88;
                                        }
                                        else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        {
                                            newSlot.Lect_Sub_ID = 90;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        {
                                            newSlot.Lect_Sub_ID = 92;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 94;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 96;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 bite
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 10))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITE"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();


                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 10;

                                        if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 75;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 79;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 81;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();


                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 10;

                                        if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 75;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 79;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 81;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 10))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITE"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 10;

                                        if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 75;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 79;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 81;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 10;

                                    //    if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 75;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 79;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 81;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 10;

                                        if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 75;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 79;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 81;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 3 bitd
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 9))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITD"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 9;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 65;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 67;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 69;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 71;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 9;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 65;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 67;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 69;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 71;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 9))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITD"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 9;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 65;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 67;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 69;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 71;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 9;

                                    //    if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 65;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 67;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 69;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 71;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 9;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 65;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 67;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 69;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 71;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 2 bitd
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 8))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITD"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 8;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 53;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 55;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 57;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 59;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 61;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 8;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 53;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 55;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 57;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 59;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 61;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 8))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITD"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 8;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 53;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 55;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 57;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 59;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 61;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 8;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 53;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 55;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 57;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 59;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 61;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 8;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 53;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 55;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 57;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 59;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 61;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 bitd
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITD"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 7;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 40;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 42;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 44;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 46;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 7;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 40;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 42;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 44;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 46;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        //newSlot.Number = range.ElementAt(col);
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("1 BITD"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 7;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 40;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 42;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 44;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 46;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7 && x.Room.ID != labroom.ID))
                                    //{
                                    //    MessageBox.Show(arrayLab[p].ToString());
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 7;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 40;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 42;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 44;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 46;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 7;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 40;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 42;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 44;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 46;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                }

                            }

                            // 3 bitc
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 6))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITC"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 6;

                                        if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 29;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 31;
                                        }
                                        else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 33;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 35;
                                        }
                                        else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 37;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 6;

                                        if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 29;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 31;
                                        }
                                        else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 33;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 35;
                                        }
                                        else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 37;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 6))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITC"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 6;

                                        if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 29;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 31;
                                        }
                                        else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 33;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 35;
                                        }
                                        else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 37;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 6;

                                    //    if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 29;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 31;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 33;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 35;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 37;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 6;

                                        if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 29;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 31;
                                        }
                                        else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 33;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 35;
                                        }
                                        else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 37;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            //2 bitc
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 5))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITC"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 5;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 19;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 21;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        {
                                            newSlot.Lect_Sub_ID = 23;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 25;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 5;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 19;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 21;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        {
                                            newSlot.Lect_Sub_ID = 23;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 25;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 5))
                            {
                                if (arrayLab[p].ToString().Contains("2 BITC"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 5;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 19;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 21;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        {
                                            newSlot.Lect_Sub_ID = 23;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 25;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 5;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 19;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 21;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 23;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 25;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 5;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 19;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 21;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        {
                                            newSlot.Lect_Sub_ID = 23;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 25;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            //1 bitc
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 4))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITC"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 4;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 2;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 4;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 6;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 8;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 10;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 12;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();


                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 4;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 2;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 4;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 6;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 8;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 10;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 12;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 4))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITC"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 4;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 2;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 4;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 6;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 8;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 10;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 12;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 4;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 2;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 4;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 6;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 8;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 10;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 12;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 4;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 2;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 4;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 6;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 8;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 10;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 12;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            //2 dit
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 2))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 DIT"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        //MessageBox.Show("slot dit");
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 2;

                                        if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 265;
                                        }
                                        else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 267;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 269;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 271;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 273;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 275;
                                        }
                                        else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 277;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        {
                                            newSlot.Lect_Sub_ID = 279;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        {
                                            newSlot.Lect_Sub_ID = 280;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();


                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        //MessageBox.Show("slot2 dit");
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 2;

                                        if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 265;
                                        }
                                        else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 267;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 269;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 271;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 273;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 275;
                                        }
                                        else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 277;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        {
                                            newSlot.Lect_Sub_ID = 279;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        {
                                            newSlot.Lect_Sub_ID = 280;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        //newSlot.Number = range.ElementAt(col);

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 2))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("2 DIT"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 2;

                                        if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 265;
                                        }
                                        else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 267;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 269;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 271;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 273;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 275;
                                        }
                                        else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 277;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        {
                                            newSlot.Lect_Sub_ID = 279;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        {
                                            newSlot.Lect_Sub_ID = 280;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 2;

                                    //    if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 265;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 267;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 269;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 271;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 273;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 275;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 277;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 279;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 280;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 2;

                                        if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 265;
                                        }
                                        else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 267;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 269;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 271;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 273;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 275;
                                        }
                                        else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 277;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        {
                                            newSlot.Lect_Sub_ID = 279;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        {
                                            newSlot.Lect_Sub_ID = 280;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            //1 dit
                            if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 1))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 DIT"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 1;

                                        if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 254;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 256;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 283;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 260;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 262;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();


                                    }
                                    else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 1;

                                        if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 254;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 256;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 283;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 260;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 262;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 1))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 DIT"))
                                {
                                    if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 1;

                                        if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 254;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 256;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 283;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 260;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 262;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slots2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slots2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slots2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slots2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slots2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slots2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 1;

                                    //    if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 254;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 256;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 283;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 260;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 262;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 1;

                                        if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 254;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 256;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 283;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 260;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 262;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }
                        }
                        p++;
                    }
                }

                var slotLab = ent.Slots.ToList();
                //MessageBox.Show(slotLab.Count().ToString());
                if (p == 35)
                {
                    for (int j = 0; j < GridView1.Rows.Count; j++)
                    {
                        for (int k = 1; k < GridView1.Columns.Count; k++)
                        {
                            if (p < arrayLab.Count)
                            {
                                // 3 bitz
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 24))
                                {
                                    //MessageBox.Show("Test");
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("3 BITZ"))
                                    {
                                        //MessageBox.Show("asdas");
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 24;
                                            if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 244;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                            {
                                                newSlot.Lect_Sub_ID = 246;
                                            }
                                            else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 248;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 250;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 24;
                                            if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 244;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                            {
                                                newSlot.Lect_Sub_ID = 246;
                                            }
                                            else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 248;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 250;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 24))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITZ"))
                                    {
                                        //MessageBox.Show("HAHAH");

                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 24;
                                            if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 244;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                            {
                                                newSlot.Lect_Sub_ID = 246;
                                            }
                                            else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 248;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 250;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 24;
                                        //    if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 244;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 246;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 248;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 250;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);

                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 24;
                                            if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 244;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                            {
                                                newSlot.Lect_Sub_ID = 246;
                                            }
                                            else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 248;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 250;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }



                                    }
                                }


                                // 2 bitz
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 23))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITZ"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 23;
                                            if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 234;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 236;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 238;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 240;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                            {
                                                newSlot.Lect_Sub_ID = 242;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 23;
                                            if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 234;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 236;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 238;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 240;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                            {
                                                newSlot.Lect_Sub_ID = 242;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 23))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITZ"))
                                    {
                                        //MessageBox.Show("HAHAH");

                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 23;
                                            if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 234;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 236;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 238;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 240;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                            {
                                                newSlot.Lect_Sub_ID = 242;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 23;
                                        //    if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 234;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 236;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 238;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 240;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 242;
                                        //    }
                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }
                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 23;
                                            if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 234;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 236;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 238;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 240;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                            {
                                                newSlot.Lect_Sub_ID = 242;
                                            }
                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }
                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }



                                    }
                                }

                                // 1 bitz
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 22))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITZ"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 22;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 221;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 225;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 227;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 223;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 229;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 22;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 221;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 225;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 227;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 223;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 229;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                    }


                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 22))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITZ"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 22;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 221;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 225;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 227;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 223;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 229;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{

                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 22;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 221;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 225;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 227;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 223;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 229;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 22;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 221;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 225;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 227;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 223;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 229;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 3 bits
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 21))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITS"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 21;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 212;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 214;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 216;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 218;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 21;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 212;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 214;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 216;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 218;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 21))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("3 BITS"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 21;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 212;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 214;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 216;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 218;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{

                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 21;

                                        //    if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 212;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 214;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 216;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 218;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 21;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 212;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 214;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 216;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 218;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 2 bits
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 20))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITS"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 20;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 200;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 202;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 204;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 206;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 208;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 20;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 200;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 202;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 204;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 206;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 208;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 20))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITS"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 20;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 200;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 202;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 204;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 206;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 208;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{

                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 20;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 200;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 202;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 204;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 206;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 208;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 20;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 200;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 202;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 204;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 206;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 208;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 bits
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 19))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITS"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 19;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 187;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 189;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 191;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 193;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 19;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 187;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 189;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 191;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 193;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }


                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 19))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITS"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 19;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 187;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 189;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 191;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 193;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 19;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 187;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 189;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 191;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 193;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 19;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 187;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 189;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 191;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 193;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }


                                // 3 bitm
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 18))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITM"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 18;

                                            if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 177;
                                            }
                                            else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 179;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 181;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 183;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 185;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 18;

                                            if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 177;
                                            }
                                            else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 179;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 181;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 183;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 185;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 18))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITM"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 18;

                                            if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 177;
                                            }
                                            else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 179;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 181;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 183;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 185;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 18;

                                        //    if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 177;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 179;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 181;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 183;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 185;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 18;

                                            if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 177;
                                            }
                                            else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 179;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 181;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 183;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 185;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }


                                // 2 bitm
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 17))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITM"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 17;

                                            if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 166;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 168;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 170;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 172;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 174;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 17;

                                            if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 166;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 168;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 170;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 172;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 174;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 17))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITM"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 17;

                                            if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 166;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 168;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 170;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 172;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 174;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 17;

                                        //    if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 166;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 168;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 170;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 172;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 174;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 17;

                                            if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 166;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 168;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 170;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 172;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 174;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 bitm
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 16))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITM"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 16;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 149;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 153;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 155;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 157;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                            {
                                                newSlot.Lect_Sub_ID = 151;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 16;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 149;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 153;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 155;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 157;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                            {
                                                newSlot.Lect_Sub_ID = 151;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 16))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITM"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 16;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 149;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 153;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 155;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 157;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                            {
                                                newSlot.Lect_Sub_ID = 151;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 16;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 149;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 153;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 155;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 157;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 151;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 16;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 149;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 153;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 155;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 157;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                            {
                                                newSlot.Lect_Sub_ID = 151;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 3 biti
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 15))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITI"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 15;

                                            if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 138;
                                            }
                                            else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                            {
                                                newSlot.Lect_Sub_ID = 140;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                            {
                                                newSlot.Lect_Sub_ID = 142;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 144;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 146;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 15;

                                            if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 138;
                                            }
                                            else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                            {
                                                newSlot.Lect_Sub_ID = 140;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                            {
                                                newSlot.Lect_Sub_ID = 142;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 144;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 146;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 15))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITI"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 15;

                                            if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 138;
                                            }
                                            else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                            {
                                                newSlot.Lect_Sub_ID = 140;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                            {
                                                newSlot.Lect_Sub_ID = 142;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 144;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 146;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 15;

                                        //    if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 138;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 140;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 142;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 144;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 146;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 15;

                                            if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 138;
                                            }
                                            else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                            {
                                                newSlot.Lect_Sub_ID = 140;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                            {
                                                newSlot.Lect_Sub_ID = 142;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 144;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 146;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 2 biti
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 14))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITI"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 14;

                                            if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 124;
                                            }
                                            else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 126;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 128;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 130;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 132;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 134;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 14;

                                            if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 124;
                                            }
                                            else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 126;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 128;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 130;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 132;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 134;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 14))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITI"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 14;

                                            if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 124;
                                            }
                                            else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 126;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 128;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 130;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 132;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 134;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 14;

                                        //    if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 124;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 126;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 128;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 130;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 132;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 134;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 14;

                                            if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 124;
                                            }
                                            else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 126;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 128;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 130;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 132;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 134;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 biti
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 13))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITI"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 13;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 107;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 109;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 111;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 113;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 115;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 117;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 13;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 107;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 109;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 111;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 113;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 115;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 117;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 13))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITI"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            //MessageBox.Show("Test !slot");
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 13;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 107;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 109;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 111;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 113;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 115;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 117;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    MessageBox.Show("Test !slot2");
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 13;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 107;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 109;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 111;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 113;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 115;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 117;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            //MessageBox.Show("Test !slot3");
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 13;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 107;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 109;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 111;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 113;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 115;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 117;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 3 bite
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 12))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("3 BITE"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {

                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 12;

                                            if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 98;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 100;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 102;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 104;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 12;

                                            if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 98;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 100;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 102;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 104;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 12))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITE"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 12;

                                            if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 98;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 100;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 102;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 104;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 12;

                                        //    if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 98;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 100;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 102;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 104;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 12;

                                            if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 98;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 100;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 102;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 104;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }


                                // 2 bite
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 11))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITE"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 11;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                            {
                                                newSlot.Lect_Sub_ID = 86;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 88;
                                            }
                                            else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                            {
                                                newSlot.Lect_Sub_ID = 90;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                            {
                                                newSlot.Lect_Sub_ID = 92;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 94;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 96;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 11;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                            {
                                                newSlot.Lect_Sub_ID = 86;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 88;
                                            }
                                            else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                            {
                                                newSlot.Lect_Sub_ID = 90;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                            {
                                                newSlot.Lect_Sub_ID = 92;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 94;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 96;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 11))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITE"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 11;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                            {
                                                newSlot.Lect_Sub_ID = 86;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 88;
                                            }
                                            else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                            {
                                                newSlot.Lect_Sub_ID = 90;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                            {
                                                newSlot.Lect_Sub_ID = 92;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 94;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 96;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 11;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 86;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 88;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 90;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 92;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 94;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 96;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 11;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                            {
                                                newSlot.Lect_Sub_ID = 86;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 88;
                                            }
                                            else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                            {
                                                newSlot.Lect_Sub_ID = 90;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                            {
                                                newSlot.Lect_Sub_ID = 92;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 94;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 96;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 bite
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 10))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITE"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();


                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 10;

                                            if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 75;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 79;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 81;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();


                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 10;

                                            if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 75;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 79;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 81;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 10))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITE"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 10;

                                            if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 75;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 79;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 81;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 10;

                                        //    if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 75;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 79;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 81;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 10;

                                            if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 75;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 79;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 81;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 3 bitd
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 9))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITD"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 9;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 65;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 67;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 69;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 71;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 9;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 65;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 67;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 69;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 71;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 9))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITD"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 9;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 65;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 67;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 69;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 71;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 9;

                                        //    if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 65;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 67;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 69;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 71;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 9;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 65;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 67;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 69;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 71;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 2 bitd
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 8))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITD"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 8;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 53;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 55;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 57;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 59;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 61;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 8;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 53;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 55;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 57;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 59;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 61;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 8))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITD"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 8;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 53;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 55;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 57;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 59;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 61;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 8;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 53;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 55;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 57;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 59;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 61;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 8;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 53;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 55;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 57;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 59;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 61;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 bitd
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITD"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 7;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 40;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 42;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 44;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 46;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 7;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 40;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 42;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 44;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 46;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            //newSlot.Number = range.ElementAt(col);
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("1 BITD"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 7;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 40;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 42;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 44;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 46;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7 && x.Room.ID != labroom.ID))
                                        //{
                                        //    MessageBox.Show(arrayLab[p].ToString());
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 7;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 40;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 42;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 44;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 46;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 7;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 40;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 42;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 44;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 46;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                    }

                                }

                                // 3 bitc
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 6))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITC"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 6;

                                            if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 29;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 31;
                                            }
                                            else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 33;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 35;
                                            }
                                            else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 37;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 6;

                                            if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 29;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 31;
                                            }
                                            else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 33;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 35;
                                            }
                                            else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 37;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 6))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITC"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 6;

                                            if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 29;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 31;
                                            }
                                            else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 33;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 35;
                                            }
                                            else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 37;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 6;

                                        //    if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 29;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 31;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 33;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 35;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 37;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 6;

                                            if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 29;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 31;
                                            }
                                            else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 33;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 35;
                                            }
                                            else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 37;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                //2 bitc
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 5))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITC"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 5;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 19;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 21;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                            {
                                                newSlot.Lect_Sub_ID = 23;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 25;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 5;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 19;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 21;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                            {
                                                newSlot.Lect_Sub_ID = 23;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 25;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 5))
                                {
                                    if (arrayLab[p].ToString().Contains("2 BITC"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 5;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 19;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 21;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                            {
                                                newSlot.Lect_Sub_ID = 23;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 25;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 5;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 19;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 21;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 23;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 25;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 5;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 19;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 21;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                            {
                                                newSlot.Lect_Sub_ID = 23;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 25;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                //1 bitc
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 4))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITC"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 4;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 2;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 4;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 6;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 8;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 10;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 12;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();


                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 4;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 2;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 4;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 6;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 8;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 10;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 12;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 4))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITC"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 4;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 2;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 4;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 6;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 8;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 10;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 12;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 4;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 2;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 4;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 6;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 8;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 10;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 12;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 4;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 2;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 4;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 6;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 8;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 10;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 12;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                //2 dit
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 2))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 DIT"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            //MessageBox.Show("slot dit");
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 2;

                                            if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 265;
                                            }
                                            else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 267;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 269;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 271;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 273;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 275;
                                            }
                                            else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 277;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                            {
                                                newSlot.Lect_Sub_ID = 279;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                            {
                                                newSlot.Lect_Sub_ID = 280;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();


                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            //MessageBox.Show("slot2 dit");
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 2;

                                            if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 265;
                                            }
                                            else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 267;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 269;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 271;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 273;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 275;
                                            }
                                            else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 277;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                            {
                                                newSlot.Lect_Sub_ID = 279;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                            {
                                                newSlot.Lect_Sub_ID = 280;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            //newSlot.Number = range.ElementAt(col);

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 2))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("2 DIT"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 2;

                                            if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 265;
                                            }
                                            else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 267;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 269;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 271;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 273;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 275;
                                            }
                                            else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 277;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                            {
                                                newSlot.Lect_Sub_ID = 279;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                            {
                                                newSlot.Lect_Sub_ID = 280;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 2;

                                        //    if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 265;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 267;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 269;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 271;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 273;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 275;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 277;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 279;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 280;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 2;

                                            if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 265;
                                            }
                                            else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 267;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 269;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 271;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 273;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 275;
                                            }
                                            else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 277;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                            {
                                                newSlot.Lect_Sub_ID = 279;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                            {
                                                newSlot.Lect_Sub_ID = 280;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                //1 dit
                                if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 1))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 DIT"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 1;

                                            if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 254;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 256;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 283;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 260;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 262;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();


                                        }
                                        else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 1;

                                            if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 254;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 256;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 283;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 260;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 262;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 1))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 DIT"))
                                    {
                                        if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 1;

                                            if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 254;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 256;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 283;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 260;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 262;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 1;

                                        //    if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 254;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 256;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 283;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 260;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 262;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 1;

                                            if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 254;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 256;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 283;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 260;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 262;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }
                            }
                            p++;
                        }
                    }
                }


                //var slotLab3 = ent.Slots.ToList();

                //if (p == 105)
                //{

                //}

                MessageBox.Show("Success data has been inserted !", "Success", MessageBoxButtons.OK, MessageBoxIcon.Information);
                Button4.Enabled = false;
                Button1.Enabled = false;
                //Button5.Enabled = true;
            }

        }

        protected void Button5_Click(object sender, EventArgs e)
        {
            if (MessageBox.Show("Do you want to generate timetable for all course", "Warning", MessageBoxButtons.YesNo, MessageBoxIcon.Warning) == DialogResult.Yes)
            {
                // all labs
                var roomLab = ent.Rooms.Where(x => x.Type_ID == 2).ToList().ToArray();
                int rangelab = rnd.Next(roomLab.Count());
                int rangelab2 = rnd.Next(roomLab.Count());
                int rangelab3 = rnd.Next(roomLab.Count());
                //MessageBox.Show(rangelab + "," + rangelab2);
                var labroom = roomLab[rangelab];
                var labroom2 = roomLab[rangelab2];
                var labroom3 = roomLab[rangelab3];

                //DIT
                var sub1DITLab = ent.View_1DIT.Where(x => x.Name.Contains("1 DIT") && x.CodeName.StartsWith("DIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2DITLab = ent.View_1DIT.Where(x => x.Name.Contains("2 DIT") && x.CodeName.StartsWith("DIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITC
                var sub1BITCLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITC") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITCLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITC") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITCLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITC") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITD
                var sub1BITDLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITD") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITDLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITD") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITDLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITD") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITE
                var sub1BITELab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITE") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITELab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITE") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITELab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITE") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITI
                var sub1BITILab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITI") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITILab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITI") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITILab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITI") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITM
                var sub1BITMLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITM") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITMLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITM") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITMLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITM") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITS
                var sub1BITSLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITS") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITSLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITS") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITSLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITS") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                //BITZ
                var sub1BITZLab = ent.View_1DIT.Where(x => x.Name.Contains("1 BITZ") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub2BITZLab = ent.View_1DIT.Where(x => x.Name.Contains("2 BITZ") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();
                var sub3BITZLab = ent.View_1DIT.Where(x => x.Name.Contains("3 BITZ") && x.CodeName.StartsWith("BIT") && x.TypeID == 2).Select(x => x.SubjectName + nl + x.Name + nl + x.TypeName).ToList().ToArray();

                ArrayList arrayLab = new ArrayList();

                for (int l = 0; l < sub2DITLab.Count(); l++)
                {
                    //BITZ
                    if (l < sub3BITZLab.Count())
                    {
                        arrayLab.Add(sub3BITZLab[l]);
                    }
                    if (l < sub2BITZLab.Count())
                    {
                        arrayLab.Add(sub2BITZLab[l]);
                    }
                    if (l < sub1BITZLab.Count())
                    {
                        arrayLab.Add(sub1BITZLab[l]);
                    }

                    //BITS
                    if (l < sub3BITSLab.Count())
                    {
                        arrayLab.Add(sub3BITSLab[l]);
                    }
                    if (l < sub2BITSLab.Count())
                    {
                        arrayLab.Add(sub2BITSLab[l]);
                    }
                    if (l < sub1BITSLab.Count())
                    {
                        arrayLab.Add(sub1BITSLab[l]);
                    }

                    //BITM
                    if (l < sub3BITMLab.Count())
                    {
                        arrayLab.Add(sub3BITMLab[l]);
                    }
                    if (l < sub2BITMLab.Count())
                    {
                        arrayLab.Add(sub2BITMLab[l]);
                    }
                    if (l < sub1BITMLab.Count())
                    {
                        arrayLab.Add(sub1BITMLab[l]);
                    }

                    //BITI
                    if (l < sub3BITILab.Count())
                    {
                        arrayLab.Add(sub3BITILab[l]);
                    }
                    if (l < sub2BITILab.Count())
                    {
                        arrayLab.Add(sub2BITILab[l]);
                    }
                    if (l < sub1BITILab.Count())
                    {
                        arrayLab.Add(sub1BITILab[l]);
                    }

                    //BITE
                    if (l < sub3BITELab.Count())
                    {
                        arrayLab.Add(sub3BITELab[l]);
                    }
                    if (l < sub2BITELab.Count())
                    {
                        arrayLab.Add(sub2BITELab[l]);
                    }
                    if (l < sub1BITELab.Count())
                    {
                        arrayLab.Add(sub1BITELab[l]);
                    }

                    //BITD
                    if (l < sub3BITDLab.Count())
                    {
                        arrayLab.Add(sub3BITDLab[l]);
                    }
                    if (l < sub2BITDLab.Count())
                    {
                        arrayLab.Add(sub2BITDLab[l]);
                    }
                    if (l < sub1BITDLab.Count())
                    {
                        arrayLab.Add(sub1BITDLab[l]);
                    }

                    //BITC
                    if (l < sub3BITCLab.Count())
                    {
                        arrayLab.Add(sub3BITCLab[l]);
                    }
                    if (l < sub2BITCLab.Count())
                    {
                        arrayLab.Add(sub2BITCLab[l]);
                    }
                    if (l < sub1BITCLab.Count())
                    {
                        arrayLab.Add(sub1BITCLab[l]);
                    }

                    //DIT
                    if (l < sub1DITLab.Count())
                    {
                        arrayLab.Add(sub1DITLab[l]);
                    }
                    if (l < sub2DITLab.Count())
                    {
                        arrayLab.Add(sub2DITLab[l]);
                    }


                }

                var kira = ent.Slots.ToList();
                //var slots2 = ent.Slots.ToList();
                int p = 70;

                var slotLab2 = ent.Slots.ToList();
                //MessageBox.Show(p.ToString());
                for (int j = 0; j < GridView1.Rows.Count; j++)
                {
                    for (int k = 1; k < GridView1.Columns.Count; k++)
                    {
                        if (p < arrayLab.Count)
                        {
                            // 3 bitz
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 24))
                            {
                                //MessageBox.Show("Test");
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("3 BITZ"))
                                {
                                    MessageBox.Show("asdas");
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 24;
                                        if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 244;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        {
                                            newSlot.Lect_Sub_ID = 246;
                                        }
                                        else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 248;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 250;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 24;
                                        if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 244;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        {
                                            newSlot.Lect_Sub_ID = 246;
                                        }
                                        else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 248;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 250;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 24))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITZ"))
                                {
                                    //MessageBox.Show("HAHAH");

                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 24;
                                        if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 244;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        {
                                            newSlot.Lect_Sub_ID = 246;
                                        }
                                        else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 248;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 250;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 24;
                                    //    if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 244;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 246;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 248;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 250;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);

                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 24;
                                        if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 244;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        {
                                            newSlot.Lect_Sub_ID = 246;
                                        }
                                        else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 248;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 250;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }



                                }
                            }


                            // 2 bitz
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 23))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITZ"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 23;
                                        if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 234;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 236;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 238;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 240;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        {
                                            newSlot.Lect_Sub_ID = 242;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 23;
                                        if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 234;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 236;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 238;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 240;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        {
                                            newSlot.Lect_Sub_ID = 242;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 23))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITZ"))
                                {
                                    //MessageBox.Show("HAHAH");

                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 23;
                                        if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 234;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 236;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 238;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 240;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        {
                                            newSlot.Lect_Sub_ID = 242;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 23;
                                    //    if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 234;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 236;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 238;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 240;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 242;
                                    //    }
                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }
                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 23;
                                        if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 234;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 236;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 238;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 240;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        {
                                            newSlot.Lect_Sub_ID = 242;
                                        }
                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }
                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }



                                }
                            }

                            // 1 bitz
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 22))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITZ"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 22;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 221;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 225;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 227;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 223;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 229;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 22;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 221;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 225;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 227;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 223;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 229;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                }


                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 22))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITZ"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 22;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 221;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 225;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 227;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 223;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 229;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{

                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 22;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 221;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 225;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 227;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 223;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 229;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 22;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 221;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 225;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 227;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 223;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 229;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 3 bits
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 21))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITS"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        rangelab3 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 21;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 212;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 214;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 216;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 218;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 21;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 212;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 214;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 216;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 218;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 21))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("3 BITS"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 21;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 212;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 214;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 216;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 218;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{

                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 21;

                                    //    if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 212;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 214;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 216;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 218;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 21;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 212;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 214;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 216;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 218;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 2 bits
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 20))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITS"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 20;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 200;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 202;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 204;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 206;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 208;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 20;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 200;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 202;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 204;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 206;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 208;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 20))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITS"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 20;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 200;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 202;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 204;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 206;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 208;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{

                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 20;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 200;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 202;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 204;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 206;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 208;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 20;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 200;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 202;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 204;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 206;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 208;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 bits
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 19))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITS"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 19;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 187;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 189;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 191;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 193;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 19;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 187;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 189;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 191;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 193;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }


                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 19))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITS"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 19;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 187;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 189;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 191;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 193;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 19;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 187;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 189;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 191;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 193;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 19;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 187;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 189;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 191;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 193;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }


                            // 3 bitm
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 18))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITM"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 18;

                                        if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 177;
                                        }
                                        else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 179;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 181;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 183;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 185;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 18;

                                        if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 177;
                                        }
                                        else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 179;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 181;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 183;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 185;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 18))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITM"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 18;

                                        if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 177;
                                        }
                                        else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 179;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 181;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 183;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 185;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 18;

                                    //    if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 177;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 179;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 181;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 183;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 185;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}

                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 18;

                                        if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 177;
                                        }
                                        else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 179;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 181;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 183;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 185;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }


                            // 2 bitm
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 17))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITM"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 17;

                                        if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 166;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 168;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 170;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 172;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 174;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 17;

                                        if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 166;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 168;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 170;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 172;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 174;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 17))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITM"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 17;

                                        if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 166;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 168;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 170;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 172;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 174;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 17;

                                    //    if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 166;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 168;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 170;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 172;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 174;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 17;

                                        if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 166;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 168;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 170;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 172;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 174;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 bitm
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 16))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITM"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 16;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 149;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 153;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 155;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 157;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        {
                                            newSlot.Lect_Sub_ID = 151;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 16;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 149;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 153;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 155;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 157;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        {
                                            newSlot.Lect_Sub_ID = 151;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 16))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITM"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 16;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 149;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 153;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 155;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 157;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        {
                                            newSlot.Lect_Sub_ID = 151;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 16;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 149;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 153;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 155;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 157;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 151;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 16;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 149;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 153;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 155;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 157;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        {
                                            newSlot.Lect_Sub_ID = 151;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 3 biti
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 15))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITI"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 15;

                                        if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 138;
                                        }
                                        else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        {
                                            newSlot.Lect_Sub_ID = 140;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        {
                                            newSlot.Lect_Sub_ID = 142;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 144;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 146;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 15;

                                        if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 138;
                                        }
                                        else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        {
                                            newSlot.Lect_Sub_ID = 140;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        {
                                            newSlot.Lect_Sub_ID = 142;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 144;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 146;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 15))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITI"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 15;

                                        if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 138;
                                        }
                                        else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        {
                                            newSlot.Lect_Sub_ID = 140;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        {
                                            newSlot.Lect_Sub_ID = 142;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 144;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 146;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 15;

                                    //    if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 138;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 140;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 142;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 144;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 146;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 15;

                                        if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 138;
                                        }
                                        else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        {
                                            newSlot.Lect_Sub_ID = 140;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        {
                                            newSlot.Lect_Sub_ID = 142;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 144;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 146;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 2 biti
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 14))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITI"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 14;

                                        if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 124;
                                        }
                                        else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 126;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 128;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 130;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 132;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 134;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 14;

                                        if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 124;
                                        }
                                        else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 126;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 128;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 130;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 132;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 134;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 14))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITI"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 14;

                                        if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 124;
                                        }
                                        else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 126;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 128;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 130;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 132;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 134;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 14;

                                    //    if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 124;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 126;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 128;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 130;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 132;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 134;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 14;

                                        if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 124;
                                        }
                                        else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 126;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 128;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 130;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 132;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 134;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 biti
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 13))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITI"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 13;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 107;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 109;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 111;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 113;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 115;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 117;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 13;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 107;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 109;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 111;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 113;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 115;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 117;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 13))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITI"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        //MessageBox.Show("Test !slot");
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 13;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 107;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 109;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 111;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 113;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 115;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 117;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    MessageBox.Show("Test !slot2");
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 13;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 107;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 109;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 111;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 113;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 115;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 117;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        //MessageBox.Show("Test !slot3");
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 13;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 107;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 109;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 111;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 113;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 115;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 117;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 3 bite
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 12))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("3 BITE"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {

                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 12;

                                        if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 98;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 100;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 102;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 104;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 12;

                                        if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 98;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 100;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 102;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 104;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 12))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITE"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 12;

                                        if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 98;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 100;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 102;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 104;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 12;

                                    //    if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 98;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 100;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 102;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 104;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 12;

                                        if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 98;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 100;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 102;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 104;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }


                            // 2 bite
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 11))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITE"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 11;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        {
                                            newSlot.Lect_Sub_ID = 86;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 88;
                                        }
                                        else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        {
                                            newSlot.Lect_Sub_ID = 90;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        {
                                            newSlot.Lect_Sub_ID = 92;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 94;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 96;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 11;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        {
                                            newSlot.Lect_Sub_ID = 86;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 88;
                                        }
                                        else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        {
                                            newSlot.Lect_Sub_ID = 90;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        {
                                            newSlot.Lect_Sub_ID = 92;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 94;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 96;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 11))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITE"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 11;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        {
                                            newSlot.Lect_Sub_ID = 86;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 88;
                                        }
                                        else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        {
                                            newSlot.Lect_Sub_ID = 90;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        {
                                            newSlot.Lect_Sub_ID = 92;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 94;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 96;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 11;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 86;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 88;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 90;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 92;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 94;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 96;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 11;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        {
                                            newSlot.Lect_Sub_ID = 86;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 88;
                                        }
                                        else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        {
                                            newSlot.Lect_Sub_ID = 90;
                                        }
                                        else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        {
                                            newSlot.Lect_Sub_ID = 92;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 94;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 96;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 bite
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 10))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITE"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();


                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 10;

                                        if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 75;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 79;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 81;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();


                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 10;

                                        if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 75;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 79;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 81;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 10))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITE"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 10;

                                        if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 75;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 79;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 81;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 10;

                                    //    if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 75;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 79;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 81;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 10;

                                        if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 75;
                                        }
                                        else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 79;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 81;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 3 bitd
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 9))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITD"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 9;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 65;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 67;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 69;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 71;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 9;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 65;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 67;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 69;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 71;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 9))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITD"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 9;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 65;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 67;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 69;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 71;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 9;

                                    //    if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 65;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 67;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 69;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 71;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 9;

                                        if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 65;
                                        }
                                        else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        {
                                            newSlot.Lect_Sub_ID = 67;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 69;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 71;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 2 bitd
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 8))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITD"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 8;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 53;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 55;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 57;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 59;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 61;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 8;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 53;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 55;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 57;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 59;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 61;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 8))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITD"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 8;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 53;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 55;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 57;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 59;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 61;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 8;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 53;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 55;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 57;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 59;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 61;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 8;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 53;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 55;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 57;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 59;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 61;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            // 1 bitd
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITD"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 7;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 40;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 42;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 44;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 46;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 7;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 40;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 42;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 44;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 46;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        //newSlot.Number = range.ElementAt(col);
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("1 BITD"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 7;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 40;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 42;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 44;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 46;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7 && x.Room.ID != labroom.ID))
                                    //{
                                    //    MessageBox.Show(arrayLab[p].ToString());
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 7;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 40;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 42;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 44;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 46;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 7;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 40;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 42;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 44;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 46;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }

                                }

                            }

                            // 3 bitc
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 6))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITC"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 6;

                                        if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 29;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 31;
                                        }
                                        else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 33;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 35;
                                        }
                                        else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 37;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 6;

                                        if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 29;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 31;
                                        }
                                        else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 33;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 35;
                                        }
                                        else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 37;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 6))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("3 BITC"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 6;

                                        if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 29;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 31;
                                        }
                                        else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 33;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 35;
                                        }
                                        else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 37;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 6;

                                    //    if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 29;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 31;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 33;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 35;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 37;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 6;

                                        if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        {
                                            newSlot.Lect_Sub_ID = 29;
                                        }
                                        else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 31;
                                        }
                                        else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        {
                                            newSlot.Lect_Sub_ID = 33;
                                        }
                                        else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        {
                                            newSlot.Lect_Sub_ID = 35;
                                        }
                                        else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 37;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            //2 bitc
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 5))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 BITC"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 5;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 19;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 21;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        {
                                            newSlot.Lect_Sub_ID = 23;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 25;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 5;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 19;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 21;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        {
                                            newSlot.Lect_Sub_ID = 23;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 25;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 5))
                            {
                                if (arrayLab[p].ToString().Contains("2 BITC"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 5;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 19;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 21;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        {
                                            newSlot.Lect_Sub_ID = 23;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 25;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 5;

                                    //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 19;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 21;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 23;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 25;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }


                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 5;

                                        if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 19;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 21;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        {
                                            newSlot.Lect_Sub_ID = 23;
                                        }
                                        else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 25;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }


                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            //1 bitc
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 4))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITC"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 4;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 2;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 4;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 6;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 8;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 10;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 12;
                                        }


                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();


                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 4;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 2;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 4;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 6;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 8;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 10;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 12;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 4))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 BITC"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 4;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 2;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 4;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 6;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 8;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 10;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 12;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 4;

                                    //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 2;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 4;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 6;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 8;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 10;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 12;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 4;

                                        if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 2;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        {
                                            newSlot.Lect_Sub_ID = 4;
                                        }
                                        else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        {
                                            newSlot.Lect_Sub_ID = 6;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 8;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        {
                                            newSlot.Lect_Sub_ID = 10;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 12;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            //2 dit
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 2))
                            {

                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("2 DIT"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        //MessageBox.Show("slot dit");
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 2;

                                        if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 265;
                                        }
                                        else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 267;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 269;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 271;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 273;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 275;
                                        }
                                        else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 277;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        {
                                            newSlot.Lect_Sub_ID = 279;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        {
                                            newSlot.Lect_Sub_ID = 280;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();


                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                       // MessageBox.Show("slot2 dit");
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 2;

                                        if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 265;
                                        }
                                        else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 267;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 269;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 271;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 273;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 275;
                                        }
                                        else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 277;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        {
                                            newSlot.Lect_Sub_ID = 279;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        {
                                            newSlot.Lect_Sub_ID = 280;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        //newSlot.Number = range.ElementAt(col);

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 2))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                if (arrayLab[p].ToString().Contains("2 DIT"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        //MessageBox.Show("Test");
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 2;

                                        if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 265;
                                        }
                                        else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 267;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 269;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 271;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 273;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 275;
                                        }
                                        else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 277;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        {
                                            newSlot.Lect_Sub_ID = 279;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        {
                                            newSlot.Lect_Sub_ID = 280;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();

                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 2;

                                    //    if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 265;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 267;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 269;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 271;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 273;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 275;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 277;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 279;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 280;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        //MessageBox.Show("Test 2");
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 2;

                                        if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        {
                                            newSlot.Lect_Sub_ID = 265;
                                        }
                                        else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 267;
                                        }
                                        else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        {
                                            newSlot.Lect_Sub_ID = 269;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        {
                                            newSlot.Lect_Sub_ID = 271;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        {
                                            newSlot.Lect_Sub_ID = 273;
                                        }
                                        else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        {
                                            newSlot.Lect_Sub_ID = 275;
                                        }
                                        else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        {
                                            newSlot.Lect_Sub_ID = 277;
                                        }
                                        else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        {
                                            newSlot.Lect_Sub_ID = 279;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        {
                                            newSlot.Lect_Sub_ID = 280;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            //1 dit
                            if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 1))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 DIT"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 1;

                                        if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 254;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 256;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 283;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 260;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 262;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();


                                    }
                                    else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    {
                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 1;

                                        if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 254;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 256;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 283;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 260;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 262;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }

                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }

                            if (!slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 1))
                            {
                                rangelab = rnd.Next(roomLab.Count());
                                rangelab2 = rnd.Next(roomLab.Count());
                                rangelab3 = rnd.Next(roomLab.Count());

                                labroom = roomLab[rangelab];
                                labroom2 = roomLab[rangelab2];
                                labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                if (arrayLab[p].ToString().Contains("1 DIT"))
                                {
                                    if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                    {
                                        rangelab = rnd.Next(roomLab.Count());
                                        rangelab2 = rnd.Next(roomLab.Count());

                                        labroom = roomLab[rangelab];
                                        labroom2 = roomLab[rangelab2];
                                        labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                        var excludeIsnin = new HashSet<int>();
                                        var excludeSelasa = new HashSet<int>();
                                        var excludeRabu = new HashSet<int>();
                                        var excludeKhamis = new HashSet<int>();
                                        var excludeJumaat = new HashSet<int>();

                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom2.ID;

                                        newSlot.Course_ID = 1;

                                        if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 254;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 256;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 283;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 260;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 262;
                                        }

                                        // day
                                        if (j == 0) // hari isnin
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 1;

                                            var isnin = slotLab2.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < isnin.Count(); z++)
                                            {
                                                excludeIsnin.Add(isnin[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 1) // hari selasa
                                        {

                                            // hari
                                            newSlot.Timetable_ID = 2;

                                            var selasa = slotLab2.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < selasa.Count(); z++)
                                            {
                                                excludeSelasa.Add(selasa[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 2) // hari rabu
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 3;

                                            var rabu = slotLab2.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < rabu.Count(); z++)
                                            {
                                                excludeRabu.Add(rabu[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeRabu.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else if (j == 3) // hari khamis
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 4;

                                            var khamis = slotLab2.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < khamis.Count(); z++)
                                            {
                                                excludeKhamis.Add(khamis[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        else // hari jumaat
                                        {
                                            // hari
                                            newSlot.Timetable_ID = 5;

                                            var jumaat = slotLab2.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                            for (int z = 0; z < jumaat.Count(); z++)
                                            {
                                                excludeJumaat.Add(jumaat[z].Number.Value);
                                            }

                                            var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                            int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                            newSlot.Number = range.ElementAt(index);
                                        }
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                    //else if (slotLab2.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                    //{
                                    //    Slot newSlot = new Slot();
                                    //    newSlot.ID = kira.Count() + 1;
                                    //    newSlot.Room_ID = labroom.ID;

                                    //    newSlot.Course_ID = 1;

                                    //    if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 254;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 256;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 283;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 260;
                                    //    }
                                    //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                    //    {
                                    //        newSlot.Lect_Sub_ID = 262;
                                    //    }

                                    //    // day
                                    //    if (j == 0)
                                    //    {
                                    //        newSlot.Timetable_ID = 1;
                                    //    }
                                    //    else if (j == 1)
                                    //    {
                                    //        newSlot.Timetable_ID = 2;
                                    //    }
                                    //    else if (j == 2)
                                    //    {
                                    //        newSlot.Timetable_ID = 3;
                                    //    }
                                    //    else if (j == 3)
                                    //    {
                                    //        newSlot.Timetable_ID = 4;
                                    //    }
                                    //    else
                                    //    {
                                    //        newSlot.Timetable_ID = 5;
                                    //    }

                                    //    

                                    //    newSlot.Number = range.ElementAt(col);
                                    //    ent.Slots.Add(newSlot);
                                    //    ent.SaveChanges();
                                    //}
                                    else
                                    {
                                        Slot newSlot = new Slot();
                                        newSlot.ID = kira.Count() + 1;
                                        newSlot.Room_ID = labroom.ID;

                                        newSlot.Course_ID = 1;

                                        if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        {
                                            newSlot.Lect_Sub_ID = 254;
                                        }
                                        else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        {
                                            newSlot.Lect_Sub_ID = 256;
                                        }
                                        else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        {
                                            newSlot.Lect_Sub_ID = 283;
                                        }
                                        else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        {
                                            newSlot.Lect_Sub_ID = 260;
                                        }
                                        else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        {
                                            newSlot.Lect_Sub_ID = 262;
                                        }

                                        // day
                                        if (j == 0)
                                        {
                                            newSlot.Timetable_ID = 1;
                                        }
                                        else if (j == 1)
                                        {
                                            newSlot.Timetable_ID = 2;
                                        }
                                        else if (j == 2)
                                        {
                                            newSlot.Timetable_ID = 3;
                                        }
                                        else if (j == 3)
                                        {
                                            newSlot.Timetable_ID = 4;
                                        }
                                        else
                                        {
                                            newSlot.Timetable_ID = 5;
                                        }

                                        newSlot.Number = k;
                                        ent.Slots.Add(newSlot);
                                        ent.SaveChanges();
                                    }
                                }
                            }
                        }
                        p++;
                    }
                }

                var slotLab3 = ent.Slots.ToList();
                if (p == 105)
                {
                    for (int j = 0; j < GridView1.Rows.Count; j++)
                    {
                        for (int k = 1; k < GridView1.Columns.Count; k++)
                        {
                            if (p < arrayLab.Count)
                            {
                                // 3 bitz
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 24))
                                {
                                    //MessageBox.Show("Test");
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("3 BITZ"))
                                    {
                                        //MessageBox.Show("asdas");
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 24;
                                            if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 244;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                            {
                                                newSlot.Lect_Sub_ID = 246;
                                            }
                                            else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 248;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 250;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 24;
                                            if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 244;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                            {
                                                newSlot.Lect_Sub_ID = 246;
                                            }
                                            else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 248;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 250;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 24))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITZ"))
                                    {
                                        //MessageBox.Show("HAHAH");

                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 24;
                                            if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 244;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                            {
                                                newSlot.Lect_Sub_ID = 246;
                                            }
                                            else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 248;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 250;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 24;
                                        //    if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 244;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 246;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 248;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 250;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);

                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 24;
                                            if (arrayLab[p].ToString().Contains("DIGITAL FORENSIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 244;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WATERMARKING AND STEGANOGRAPHY"))
                                            {
                                                newSlot.Lect_Sub_ID = 246;
                                            }
                                            else if (arrayLab[p].ToString().Contains("COMPUTER AUDIT AND RISK MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 248;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HACKING TECHNIQUES AND PREVENTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 250;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }



                                    }
                                }


                                // 2 bitz
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 23))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITZ"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 23;
                                            if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 234;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 236;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 238;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 240;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                            {
                                                newSlot.Lect_Sub_ID = 242;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 23;
                                            if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 234;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 236;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 238;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 240;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                            {
                                                newSlot.Lect_Sub_ID = 242;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 23))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITZ"))
                                    {
                                        //MessageBox.Show("HAHAH");

                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 23;
                                            if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 234;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 236;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 238;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 240;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                            {
                                                newSlot.Lect_Sub_ID = 242;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 23).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 23;
                                        //    if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 234;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 236;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 238;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 240;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 242;
                                        //    }
                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }
                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 23;
                                            if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 234;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 236;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK SECURITY INFRASTRUCTURE AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 238;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PHYSICAL SECURITY AND ELECTRONIC SURVEILLANCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 240;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CYBER LAW AND SECURITY POLICY"))
                                            {
                                                newSlot.Lect_Sub_ID = 242;
                                            }
                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }
                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }



                                    }
                                }

                                // 1 bitz
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 22))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITZ"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 22;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 221;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 225;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 227;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 223;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 229;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 22;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 221;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 225;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 227;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 223;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 229;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                    }


                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 22))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITZ"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 22;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 221;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 225;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 227;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 223;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 229;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 22).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{

                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 22;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 221;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 225;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 227;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 223;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 229;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 22;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 221;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 225;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 227;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 223;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 229;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 3 bits
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 21))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITS"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            rangelab3 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 21;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 212;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 214;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 216;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 218;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 21;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 212;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 214;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 216;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 218;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 21))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("3 BITS"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 21;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 212;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 214;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 216;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 218;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 21).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{

                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 21;

                                        //    if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 212;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 214;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 216;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 218;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 21;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 212;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 214;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SPECIAL TOPIC IN SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 216;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 218;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 2 bits
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 20))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITS"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 20;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 200;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 202;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 204;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 206;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 208;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 20;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 200;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 202;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 204;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 206;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 208;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 20))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITS"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 20;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 200;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 202;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 204;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 206;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 208;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 20).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{

                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 20;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 200;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 202;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 204;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 206;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 208;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 20;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 200;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 202;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 204;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE VERIFICATION AND VALIDATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 206;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 208;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 bits
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 19))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITS"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 19;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 187;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 189;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 191;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 193;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 19;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 187;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 189;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 191;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 193;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }


                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 19))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITS"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 19;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 187;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 189;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 191;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 193;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 19).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 19;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 187;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 189;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 191;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 193;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 19;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 187;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 189;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 191;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 193;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }


                                // 3 bitm
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 18))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITM"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 18;

                                            if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 177;
                                            }
                                            else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 179;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 181;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 183;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 185;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 18;

                                            if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 177;
                                            }
                                            else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 179;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 181;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 183;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 185;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 18))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITM"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 18;

                                            if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 177;
                                            }
                                            else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 179;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 181;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 183;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 185;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 18).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 18;

                                        //    if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 177;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 179;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 181;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 183;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 185;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}

                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 18;

                                            if (arrayLab[p].ToString().Contains("MOTION GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 177;
                                            }
                                            else if (arrayLab[p].ToString().Contains("VIRTUAL REALITY TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 179;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 181;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MOBILE APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 183;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 185;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }


                                // 2 bitm
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 17))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITM"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 17;

                                            if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 166;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 168;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 170;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 172;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 174;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 17;

                                            if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 166;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 168;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 170;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 172;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 174;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 17))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITM"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 17;

                                            if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 166;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 168;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 170;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 172;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 174;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 17).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 17;

                                        //    if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 166;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 168;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 170;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 172;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 174;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 17;

                                            if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 166;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 168;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE COMPUTER GRAPHICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 170;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 172;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 174;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 bitm
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 16))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITM"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 16;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 149;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 153;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 155;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 157;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                            {
                                                newSlot.Lect_Sub_ID = 151;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 16;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 149;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 153;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 155;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 157;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                            {
                                                newSlot.Lect_Sub_ID = 151;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 16))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITM"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 16;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 149;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 153;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 155;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 157;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                            {
                                                newSlot.Lect_Sub_ID = 151;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 16).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 16;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 149;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 153;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 155;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 157;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 151;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 16;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 149;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 153;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 155;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 157;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE MEDIA AUTHORING"))
                                            {
                                                newSlot.Lect_Sub_ID = 151;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 3 biti
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 15))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITI"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 15;

                                            if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 138;
                                            }
                                            else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                            {
                                                newSlot.Lect_Sub_ID = 140;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                            {
                                                newSlot.Lect_Sub_ID = 142;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 144;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 146;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 15;

                                            if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 138;
                                            }
                                            else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                            {
                                                newSlot.Lect_Sub_ID = 140;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                            {
                                                newSlot.Lect_Sub_ID = 142;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 144;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 146;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 15))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITI"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 15;

                                            if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 138;
                                            }
                                            else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                            {
                                                newSlot.Lect_Sub_ID = 140;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                            {
                                                newSlot.Lect_Sub_ID = 142;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 144;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 146;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 15).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 15;

                                        //    if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 138;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 140;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 142;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 144;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 146;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 15;

                                            if (arrayLab[p].ToString().Contains("INTELLIGENT AGENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 138;
                                            }
                                            else if (arrayLab[p].ToString().Contains("EVOLUTIONARY COMPUTING"))
                                            {
                                                newSlot.Lect_Sub_ID = 140;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMAGE PROCESSING AND PATTERN RECOGNITION"))
                                            {
                                                newSlot.Lect_Sub_ID = 142;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 144;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 146;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 2 biti
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 14))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITI"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 14;

                                            if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 124;
                                            }
                                            else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 126;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 128;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 130;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 132;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 134;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 14;

                                            if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 124;
                                            }
                                            else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 126;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 128;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 130;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 132;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 134;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 14))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITI"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 14;

                                            if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 124;
                                            }
                                            else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 126;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 128;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 130;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 132;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 134;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 14).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 14;

                                        //    if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 124;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 126;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 128;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 130;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 132;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 134;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 14;

                                            if (arrayLab[p].ToString().Contains("LOGIC PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 124;
                                            }
                                            else if (arrayLab[p].ToString().Contains("KNOWLEDGE BASED SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 126;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MACHINE LEARNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 128;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE IN ROBOTIC AND AUTOMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 130;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 132;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 134;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 biti
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 13))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITI"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 13;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 107;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 109;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 111;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 113;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 115;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 117;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 13;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 107;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 109;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 111;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 113;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 115;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 117;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 13))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITI"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            //MessageBox.Show("Test !slot");
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 13;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 107;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 109;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 111;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 113;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 115;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 117;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 13).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    MessageBox.Show("Test !slot2");
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 13;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 107;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 109;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 111;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 113;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 115;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 117;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            //MessageBox.Show("Test !slot3");
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 13;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 107;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 109;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 111;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 113;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 115;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 117;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 3 bite
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 12))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("3 BITE"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {

                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 12;

                                            if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 98;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 100;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 102;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 104;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 12;

                                            if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 98;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 100;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 102;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 104;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 12))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITE"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 12;

                                            if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 98;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 100;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 102;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 104;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 12).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 12;

                                        //    if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 98;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 100;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 102;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 104;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 12;

                                            if (arrayLab[p].ToString().Contains("3D GAME DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 98;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PHYSICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 100;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME PROJECT MANAGEMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 102;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAME MECHANICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 104;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }


                                // 2 bite
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 11))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITE"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 11;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                            {
                                                newSlot.Lect_Sub_ID = 86;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 88;
                                            }
                                            else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                            {
                                                newSlot.Lect_Sub_ID = 90;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                            {
                                                newSlot.Lect_Sub_ID = 92;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 94;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 96;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 11;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                            {
                                                newSlot.Lect_Sub_ID = 86;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 88;
                                            }
                                            else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                            {
                                                newSlot.Lect_Sub_ID = 90;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                            {
                                                newSlot.Lect_Sub_ID = 92;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 94;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 96;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 11))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITE"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 11;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                            {
                                                newSlot.Lect_Sub_ID = 86;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 88;
                                            }
                                            else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                            {
                                                newSlot.Lect_Sub_ID = 90;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                            {
                                                newSlot.Lect_Sub_ID = 92;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 94;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 96;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 11).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 11;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 86;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 88;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 90;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 92;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 94;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 96;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 11;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE FOR GAMES"))
                                            {
                                                newSlot.Lect_Sub_ID = 86;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INTERACTIVE 3D ANIMATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 88;
                                            }
                                            else if (arrayLab[p].ToString().Contains("AUDIO VIDEO PRODUCTION FOR GAME"))
                                            {
                                                newSlot.Lect_Sub_ID = 90;
                                            }
                                            else if (arrayLab[p].ToString().Contains("GAMEPLAY"))
                                            {
                                                newSlot.Lect_Sub_ID = 92;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STATISTICS AND PROBABILITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 94;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 96;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 bite
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 10))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITE"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();


                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 10;

                                            if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 75;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 79;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 81;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();


                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 10;

                                            if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 75;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 79;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 81;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 10))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITE"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 10;

                                            if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 75;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 79;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 81;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 10).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 10;

                                        //    if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 75;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 79;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 81;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 10;

                                            if (arrayLab[p].ToString().Contains("GAME PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 75;
                                            }
                                            else if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 79;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 81;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 3 bitd
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 9))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITD"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 9;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 65;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 67;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 69;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 71;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 9;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 65;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 67;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 69;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 71;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 9))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITD"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 9;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 65;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 67;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 69;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 71;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 9).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 9;

                                        //    if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 65;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 67;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 69;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 71;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 9;

                                            if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 65;
                                            }
                                            else if (arrayLab[p].ToString().Contains("STRATEGIC INFORMATION SYSTEM PLANNING"))
                                            {
                                                newSlot.Lect_Sub_ID = 67;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 69;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ADVANCED DATABASE PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 71;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 2 bitd
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 8))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITD"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 8;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 53;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 55;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 57;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 59;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 61;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 8;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 53;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 55;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 57;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 59;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 61;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 8))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITD"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 8;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 53;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 55;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 57;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 59;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 61;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 8).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 8;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 53;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 55;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 57;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 59;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 61;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 8;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 53;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE REQUIREMENT AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 55;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 57;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OBJECT ORIENTED PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 59;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 61;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                // 1 bitd
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITD"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 7;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 40;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 42;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 44;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 46;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 7;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 40;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 42;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 44;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 46;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            //newSlot.Number = range.ElementAt(col);
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("1 BITD"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 7;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 40;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 42;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 44;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 46;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 7).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 24).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 7 && x.Room.ID != labroom.ID))
                                        //{
                                        //    MessageBox.Show(arrayLab[p].ToString());
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 7;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 40;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 42;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 44;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 46;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 7;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 40;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 42;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 44;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 46;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }

                                    }

                                }

                                // 3 bitc
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 6))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITC"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 6;

                                            if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 29;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 31;
                                            }
                                            else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 33;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 35;
                                            }
                                            else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 37;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 6;

                                            if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 29;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 31;
                                            }
                                            else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 33;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 35;
                                            }
                                            else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 37;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 6))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("3 BITC"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 6;

                                            if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 29;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 31;
                                            }
                                            else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 33;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 35;
                                            }
                                            else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 37;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 6).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 6;

                                        //    if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 29;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 31;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 33;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 35;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 37;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 6;

                                            if (arrayLab[p].ToString().Contains("INTERNET TECHNOLOGY"))
                                            {
                                                newSlot.Lect_Sub_ID = 29;
                                            }
                                            else if (arrayLab[p].ToString().Contains("MULTIMEDIA NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 31;
                                            }
                                            else if (arrayLab[p].ToString().Contains("FIBER OPTIC"))
                                            {
                                                newSlot.Lect_Sub_ID = 33;
                                            }
                                            else if (arrayLab[p].ToString().Contains("INFORMATION TECHNOLOGY AND NETWORKING SECURITY"))
                                            {
                                                newSlot.Lect_Sub_ID = 35;
                                            }
                                            else if (arrayLab[p].ToString().Contains("TCP/IP PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 37;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                //2 bitc
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 5))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 BITC"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 5;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 19;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 21;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                            {
                                                newSlot.Lect_Sub_ID = 23;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 25;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 5;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 19;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 21;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                            {
                                                newSlot.Lect_Sub_ID = 23;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 25;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 5))
                                {
                                    if (arrayLab[p].ToString().Contains("2 BITC"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 5;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 19;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 21;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                            {
                                                newSlot.Lect_Sub_ID = 23;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 25;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 5).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 5;

                                        //    if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 19;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 21;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 23;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 25;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }


                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 5;

                                            if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 19;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 21;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WIDE AREA NETWORK"))
                                            {
                                                newSlot.Lect_Sub_ID = 23;
                                            }
                                            else if (arrayLab[p].ToString().Contains("NETWORK ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 25;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }


                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                //1 bitc
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 4))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITC"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 4;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 2;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 4;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 6;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 8;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 10;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 12;
                                            }


                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();


                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 4;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 2;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 4;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 6;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 8;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 10;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 12;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 4))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 BITC"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 4;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 2;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 4;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 6;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 8;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 10;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 12;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 4).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 4;

                                        //    if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 2;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 4;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 6;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 8;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 10;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 12;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 4;

                                            if (arrayLab[p].ToString().Contains("CALCULUS AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 2;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB APPLICATION DEVELOPMENT"))
                                            {
                                                newSlot.Lect_Sub_ID = 4;
                                            }
                                            else if (arrayLab[p].ToString().Contains("HUMAN-COMPUTER INTERACTION"))
                                            {
                                                newSlot.Lect_Sub_ID = 6;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 8;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE"))
                                            {
                                                newSlot.Lect_Sub_ID = 10;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA COMMUNICATION AND NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 12;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                //2 dit
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 2))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("2 DIT"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            //MessageBox.Show("slot dit");
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 2;

                                            if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 265;
                                            }
                                            else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 267;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 269;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 271;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 273;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 275;
                                            }
                                            else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 277;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                            {
                                                newSlot.Lect_Sub_ID = 279;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                            {
                                                newSlot.Lect_Sub_ID = 280;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();


                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            //MessageBox.Show("slot2 dit");
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 2;

                                            if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 265;
                                            }
                                            else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 267;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 269;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 271;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 273;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 275;
                                            }
                                            else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 277;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                            {
                                                newSlot.Lect_Sub_ID = 279;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                            {
                                                newSlot.Lect_Sub_ID = 280;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            //newSlot.Number = range.ElementAt(col);

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 2))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                    if (arrayLab[p].ToString().Contains("2 DIT"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 2;

                                            if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 265;
                                            }
                                            else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 267;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 269;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 271;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 273;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 275;
                                            }
                                            else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 277;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                            {
                                                newSlot.Lect_Sub_ID = 279;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                            {
                                                newSlot.Lect_Sub_ID = 280;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();

                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 2;

                                        //    if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 265;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 267;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 269;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 271;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 273;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 275;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 277;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 279;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 280;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 2;

                                            if (arrayLab[p].ToString().Contains("LINEAR ALGEBRA AND NUMERICAL METHODS"))
                                            {
                                                newSlot.Lect_Sub_ID = 265;
                                            }
                                            else if (arrayLab[p].ToString().Contains("APPLIED STATISTICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 267;
                                            }
                                            else if (arrayLab[p].ToString().Contains("ARTIFICIAL INTELLIGENCE"))
                                            {
                                                newSlot.Lect_Sub_ID = 269;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATA STRUCTURE AND ALGORITHM"))
                                            {
                                                newSlot.Lect_Sub_ID = 271;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SOFTWARE ENGINEERING"))
                                            {
                                                newSlot.Lect_Sub_ID = 273;
                                            }
                                            else if (arrayLab[p].ToString().Contains("DATABASE ADMINISTRATION"))
                                            {
                                                newSlot.Lect_Sub_ID = 275;
                                            }
                                            else if (arrayLab[p].ToString().Contains("BASIC NETWORKING"))
                                            {
                                                newSlot.Lect_Sub_ID = 277;
                                            }
                                            else if (arrayLab[p].ToString().Contains("IMPLEMENTING AND ADMINISTERING ACTIVE DIRECTORY"))
                                            {
                                                newSlot.Lect_Sub_ID = 279;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM DEVELOPMENT WORKSHOP"))
                                            {
                                                newSlot.Lect_Sub_ID = 280;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 2).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                //1 dit
                                if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 1))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 DIT"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 1;

                                            if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 254;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 256;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 283;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 260;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 262;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();


                                        }
                                        else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        {
                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 1;

                                            if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 254;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 256;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 283;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 260;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 262;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }

                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }

                                if (!slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Course_ID == 1))
                                {
                                    rangelab = rnd.Next(roomLab.Count());
                                    rangelab2 = rnd.Next(roomLab.Count());
                                    rangelab3 = rnd.Next(roomLab.Count());

                                    labroom = roomLab[rangelab];
                                    labroom2 = roomLab[rangelab2];
                                    labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];
                                    if (arrayLab[p].ToString().Contains("1 DIT"))
                                    {
                                        if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID == labroom.ID))
                                        {
                                            rangelab = rnd.Next(roomLab.Count());
                                            rangelab2 = rnd.Next(roomLab.Count());

                                            labroom = roomLab[rangelab];
                                            labroom2 = roomLab[rangelab2];
                                            labroom3 = roomLab[rnd.Next(rnd.Next(rangelab))];

                                            var excludeIsnin = new HashSet<int>();
                                            var excludeSelasa = new HashSet<int>();
                                            var excludeRabu = new HashSet<int>();
                                            var excludeKhamis = new HashSet<int>();
                                            var excludeJumaat = new HashSet<int>();

                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom2.ID;

                                            newSlot.Course_ID = 1;

                                            if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 254;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 256;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 283;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 260;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 262;
                                            }

                                            // day
                                            if (j == 0) // hari isnin
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 1;

                                                var isnin = slotLab3.Where(x => x.Timetable_ID == 1 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < isnin.Count(); z++)
                                                {
                                                    excludeIsnin.Add(isnin[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeIsnin.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeIsnin.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 1) // hari selasa
                                            {

                                                // hari
                                                newSlot.Timetable_ID = 2;

                                                var selasa = slotLab3.Where(x => x.Timetable_ID == 2 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < selasa.Count(); z++)
                                                {
                                                    excludeSelasa.Add(selasa[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeSelasa.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeSelasa.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 2) // hari rabu
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 3;

                                                var rabu = slotLab3.Where(x => x.Timetable_ID == 3 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < rabu.Count(); z++)
                                                {
                                                    excludeRabu.Add(rabu[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeRabu.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeRabu.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else if (j == 3) // hari khamis
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 4;

                                                var khamis = slotLab3.Where(x => x.Timetable_ID == 4 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < khamis.Count(); z++)
                                                {
                                                    excludeKhamis.Add(khamis[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeKhamis.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeKhamis.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            else // hari jumaat
                                            {
                                                // hari
                                                newSlot.Timetable_ID = 5;

                                                var jumaat = slotLab3.Where(x => x.Timetable_ID == 5 && x.Course_ID == 1).ToList();
                                                for (int z = 0; z < jumaat.Count(); z++)
                                                {
                                                    excludeJumaat.Add(jumaat[z].Number.Value);
                                                }

                                                var range = Enumerable.Range(1, 7).Where(x => !excludeJumaat.Contains(x));
                                                int index = rnd.Next(1, 7 - excludeJumaat.Count);

                                                newSlot.Number = range.ElementAt(index);
                                            }
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                        //else if (slotLab3.Any(x => x.Timetable_ID == j + 1 && x.Number == k && x.Room.ID != labroom.ID))
                                        //{
                                        //    Slot newSlot = new Slot();
                                        //    newSlot.ID = kira.Count() + 1;
                                        //    newSlot.Room_ID = labroom.ID;

                                        //    newSlot.Course_ID = 1;

                                        //    if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 254;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 256;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 283;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 260;
                                        //    }
                                        //    else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                        //    {
                                        //        newSlot.Lect_Sub_ID = 262;
                                        //    }

                                        //    // day
                                        //    if (j == 0)
                                        //    {
                                        //        newSlot.Timetable_ID = 1;
                                        //    }
                                        //    else if (j == 1)
                                        //    {
                                        //        newSlot.Timetable_ID = 2;
                                        //    }
                                        //    else if (j == 2)
                                        //    {
                                        //        newSlot.Timetable_ID = 3;
                                        //    }
                                        //    else if (j == 3)
                                        //    {
                                        //        newSlot.Timetable_ID = 4;
                                        //    }
                                        //    else
                                        //    {
                                        //        newSlot.Timetable_ID = 5;
                                        //    }

                                        //    

                                        //    newSlot.Number = range.ElementAt(col);
                                        //    ent.Slots.Add(newSlot);
                                        //    ent.SaveChanges();
                                        //}
                                        else
                                        {
                                            Slot newSlot = new Slot();
                                            newSlot.ID = kira.Count() + 1;
                                            newSlot.Room_ID = labroom.ID;

                                            newSlot.Course_ID = 1;

                                            if (arrayLab[p].ToString().Contains("DISCRETE MATHEMATICS"))
                                            {
                                                newSlot.Lect_Sub_ID = 254;
                                            }
                                            else if (arrayLab[p].ToString().Contains("WEB PROGRAMMING"))
                                            {
                                                newSlot.Lect_Sub_ID = 256;
                                            }
                                            else if (arrayLab[p].ToString().Contains("PROGRAMMING II"))
                                            {
                                                newSlot.Lect_Sub_ID = 283;
                                            }
                                            else if (arrayLab[p].ToString().Contains("SYSTEM ANALYSIS AND DESIGN"))
                                            {
                                                newSlot.Lect_Sub_ID = 260;
                                            }
                                            else if (arrayLab[p].ToString().Contains("OPERATING SYSTEM"))
                                            {
                                                newSlot.Lect_Sub_ID = 262;
                                            }

                                            // day
                                            if (j == 0)
                                            {
                                                newSlot.Timetable_ID = 1;
                                            }
                                            else if (j == 1)
                                            {
                                                newSlot.Timetable_ID = 2;
                                            }
                                            else if (j == 2)
                                            {
                                                newSlot.Timetable_ID = 3;
                                            }
                                            else if (j == 3)
                                            {
                                                newSlot.Timetable_ID = 4;
                                            }
                                            else
                                            {
                                                newSlot.Timetable_ID = 5;
                                            }

                                            newSlot.Number = k;
                                            ent.Slots.Add(newSlot);
                                            ent.SaveChanges();
                                        }
                                    }
                                }
                            }
                            p++;
                        }
                    }
                }

                MessageBox.Show("Success data has been inserted !", "Success", MessageBoxButtons.OK, MessageBoxIcon.Information);
                Button5.Enabled = false;
                Button1.Enabled = false;
                
            }

        }

        protected void ButtonCourse_Click(object sender, EventArgs e)
        {
            string email = Session["email"].ToString();
            var whichAdmin = ent.Admins.Where(x => x.email == email).FirstOrDefault();
            Response.Redirect("adminCourse.aspx?profilename=" + whichAdmin.Name + "&id=" + whichAdmin.ID);
        }

        protected void ButtonHome2_Click(object sender, EventArgs e)
        {
            string email = Session["email"].ToString();
            var whichAdmin = ent.Admins.Where(x => x.email == email).FirstOrDefault();
            Response.Redirect("adminHome2.aspx?profilename=" + whichAdmin.Name + "&id=" + whichAdmin.ID);
        }
    }
}
